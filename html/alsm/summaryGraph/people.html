<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人口统计分析</title>
    <link href="./../../../css/statistics/css/style.css" rel="stylesheet" type="text/css" media="all"/>
    <!--<script src="./../../../js/echarts.min.js" charset="utf-8"></script>-->
    <script src="../../../alsm/ttyu.net/file/system/jq/jquery.min.js" type="text/javascript"></script>
    <script src="../../../alsm/ttyu.net/file/system/jq/jquery-ui.js" type="text/javascript"></script>
    <script src="../../../alsm/vue/vue.js"></script>
    <script src="../../../alsm/echarts/echarts.min.js"></script>
    
    <script src="../../../alsm/api_sub.js" type="text/javascript"></script>
    <script src="../../../js/config/config.js"></script>
    
    <style>
        [v-cloak] {
            display:none !important;
        }
    </style>
</head>
<body id="content">
    <div id="body1" v-cloak style="height: 100%;">
        <div class="bnt">
            <div class="topbnt_left fl">
                <ul>
                    <li class="active"><a href="#">实有人口</a></li>
                </ul>
            </div>
            <h1 class="tith1 fl">人口分析</h1>
            <div class=" fr topbnt_right">
                <ul>
                    <li id="btn" @click="fullScreen"><a href="#" >全屏展示</a></li>
                    <li><a href="#">分析报告</a></li>
                </ul>
            </div>
        </div>
        <div class="left1 pleft1">
            <div class="lefttime">
                <h2 class="tith2" style="height: 20%">统计时间</h2>
                <div class="lefttime_text">
                    <ul style="cursor: pointer;">
                        <li class="bg active" @click="changeData('month')">本月</li>
                        <li></li>
                        <li class="bg" @click="changeData('quarter')">本季</li>
                        <li></li>
                        <li class="bg" @click="changeData('year')">本年</li>
                    </ul>
                </div>
            </div>
            <div class="plefttoday">
                <h2 class="tith2">本月人口统计</h2>
                <div class="lefttoday_number">
                    <div class="lefttoday_number">
                        <div class="widget-inline-box text-center fl" v-for="(item, index) in dataLists.RKTJ">
                            <p>{{ item.name }}</p>
                            <h3 :class="colors[index]">{{ item.sum }}</h3>
                            <h4 class="text-muted">环比<img :src="imgsrc[index]" height="16"/>{{ array3[index] }}</h4>
                        </div>
                        <!-- <div class="widget-inline-box text-center fl">
                            <p>暂住人口</p>
                            <h3 class="c24c9ff">846</h3>
                            <h4 class="text-muted">环比<img src="./../../../css/statistics/img/iconup.png" height="16"/>5%</h4>
                        </div>
                        <div class="widget-inline-box text-center fl">
                            <p>重点人口</p>
                            <h3 class="cffff00">4</h3>
                            <h4 class="text-muted">环比<img src="./../../../css/statistics/img/icondown.png" height="16"/>1%</h4>
                        </div>
                        <div class="widget-inline-box text-center fl">
                            <p>总数</p>
                            <h3 class="c11e2dd">906</h3>
                            <h4 class="text-muted">环比<img src="./../../../css/statistics/img/iconup.png" height="16"/>5%</h4>
                        </div> -->
                    </div>
                </div>
            </div>
            <div class="lpeftbot" style="height: 30%;">
                <h2 class="tith2" style="line-height: 16px;">实有人口性别占比</h2>
                <div id="lpeftbot" class="lpeftbotcont"></div>
            </div>
            <div class="lpeft2bot" style="height: 23%;">
                <h2 class="tith2" style="line-height: 14px;">政治面貌</h2>
                <div class="pvr fl liwp lpeftb2otcont1" style="height:80%;">
                    <ul style="margin-top: -16px;">
                        <li class="hot1">1</li>
                        <li class="hot2">2</li>
                        <li class="hot3">3</li>
                        <li class="hot4">4</li>
                    </ul>
                    <div id="pleftbox2bott_cont" class="lpeftb2otcont" style="height:100%;"></div>
                </div>
            </div>
        </div>
        <div class="left2">
            <div class="pleftbox2midd" style="height: 23%;">
                <h2 class="tith2 pt2" style="line-height: 16px;">实有人口数量分析</h2>
                <div id="prbottom_box4" class="lpeftbotcont"></div>
            </div>
            <div class="pleftbox2top" style="height: 30%;">
                <h2 class="tith2 " style="line-height: 16px;">有无工作</h2>
                <!-- <div id="pleftbox2top" class="pleftbox2topcont"></div> -->
                <div id="lpeftbot02" class="lpeftbotcont"></div>
            </div>
            <div class="pleftbox2midd" style="height: 30%;">
                <h2 class="tith2" style="line-height: 30px;">实有人口年龄结构</h2>
                <div id="pleftbox2midd" class="pleftbox2middcont"></div>
            </div>
        </div>
        <div class="mrbox prbox">
            <div class="mrbox_top">
                <div class="mrbox_top_midd">
                    <!-- <div class="mrboxtm-mbox">
                        <h2 class="tith2 pt1">警情警力地图分析</h2>
                        <div class="mrboxtm-map" style=" ">
                            <ul>
                                <li class="bluer" style="top:28%;left:12%">15</li>
                                <li class="redr" style="top:31%;left:18%">13</li>
                                石渠县
                                <li class="bluer" style="top:31%;left:33%">15</li>
                                <li class="redr" style="top:34%;left:36%">13</li>
                                <li class="bluer" style="top:12%;left:43%">15</li>
                                <li class="redr" style="top:15%;left:47%">13</li>
                                <li class="bluer" style="top:22%;left:36%">15</li>
                                <li class="redr" style="top:25%;left:41%">13</li>
                                <li class="bluer" style="top:23%;left:57%">15</li>
                                <li class="redr" style="top:16%;left:53%">13</li>
                                <li class="bluer" style="top:26%;left:64%">15</li>
                                <li class="redr" style="top:22%;left:67%">13</li>
                                <li class="bluer" style="top:7%;left:68%">15</li>
                                <li class="redr" style="top:15%;left:69%">13</li>
                                丹巴
                                <li class="bluer" style="top:32%;left:77%">15</li>
                                <li class="redr" style="top:35%;left:80%">13</li>
                                康定
                                <li class="bluer" style="top:28%;left:81%">15</li>
                                <li class="redr" style="top:27%;left:84%">13</li>
                                泸定
                                <li class="bluer" style="top:34%;left:69%">15</li>
                                <li class="redr" style="top:37%;left:73%">13</li>
                                雅江
                                <li class="bluer" style="top:48%;left:87%">15</li>
                                <li class="redr" style="top:47%;left:83%">13</li>
                                九龙
                                <li class="bluer" style="top:48%;left:60%">15</li>
                                <li class="redr" style="top:56%;left:62%">13</li>
                                理塘
                                <li class="bluer" style="top:68%;left:60%">15</li>
                                <li class="redr" style="top:70%;left:63%">13</li>
                                巴塘
                                <li class="bluer" style="top:67%;left:67%">15</li>
                                <li class="redr" style="top:67%;left:71%">13</li>
                                乡城
                                <li class="bluer" style="top:82%;left:70%">15</li>
                                <li class="redr" style="top:84%;left:73%">13</li>
                                得荣
                                <li class="bluer" style="top:68%;left:60%">15</li>
                                <li class="redr" style="top:70%;left:63%">13</li>
                                巴塘
                                <li class="bluer" style="top:71%;left:78%">15</li>
                                <li class="redr" style="top:74%;left:81%">13</li>
                                稻城
                                <li class="bluer" style="top:31%;left:57%">15</li>
                                <li class="redr" style="top:33%;left:53%">13</li>
                                <li class="bluer" style="top:44%;left:47%">15</li>
                                <li class="redr" style="top:48%;left:52%">13</li>
                            </ul>
                        </div>
                    </div> -->
                    <!--  map end-->
                    <div class="pmrboxbottom" style="height: 35%;">
                        <h2 class="tith2" style="line-height: 30px;">实有人口民族分析</h2>
                        <div id="pleftbox2top" class="lpeftbotcont"></div>
                    </div>
                    <div class="lpeftbot02" style="height: 50%;">
                        <!-- <div id="lpeftbot02" class="lpeftbotcont"></div> -->
                        <h2 class="tith2 pt1" style="line-height: 50px;">重点人口</h2>
                        <div id="pmrboxbottom" class="pmrboxbottomcont"></div>
                    </div>
                    <!-- <div class="lpeftbot02">
                        <h2 class="tith2">有无工作</h2>
                        <div id="lpeftbot02" class="lpeftbotcont"></div>
                    </div> -->
                    <div class="lpeftbot02" style="height: 50%;">
                        <h2 class="tith2" style="line-height: 30px;">宗教信仰</h2>
                        <div id="prbottom_box3" class="lpeftbotcont">
                        </div>
                    </div>
                </div>
                <!-- mrbox_top_midd end -->
                <!-- <div class="mrbox_top_right">
                    <div class="pmrtop1">
                    <h2 class="tith2">实名制人口统计</h2>
                    <div class="pmrtop_cont1">
                        <div class="pmrtop_contheight">
                            <div class="widget-inline-box text-center fl">
                                <p>流动人口</p>
                                <h3 class="pt6 ceeb1fd">8654</h3>
                            </div>
                            <div class="widget-inline-box text-center fl" >
                                <p>重点人员</p>
                                <h3 class="pt6 c24c9ff">135622</h3>
                            </div>
                        </div>
                        <div class="lefttoday_bar" >
                            <ul>
                                <li class="c1 big1" style="top: 10%;left: 16%;"><span>交通警情6</span></li>
                                <li class="c2 big2" style="top: 35%;left: 65%;"><span>求助1</span></li>
                                <li class="c3 big4" style="top: 25%;left: 35%;"><span>无效报警2</span></li>
                                <li class="c4 big5" style="top: 65%;left: 65%;"><span>投诉2</span></li>
                                <li class="c5 big6" style="top: 65%;left: 25%;"><span>灾害事故1</span></li>
                                <li class="c6 big1" style="top: 45%;left: 15%;"><span>刑事案件1</span></li>
                                <li class="c1 big0" style="top: 35%;left: 75%;"></li>
                                <li class="c2 big0" style="top: 85%;left: 55%;"></li>
                                <li class="c3 big0" style="top: 85%;left: 15%;"></li>
                            </ul>
                        </div>
                    </div>
                </div> -->
                <!-- pmrtop  -->

                <!-- <div class="pmrtop" style=" margin-top: 3.3%">
                    <h2 class="tith2">实名制人口统计</h2>
                    <div class="pmrtop_cont pmrtop_wid" >
                        <div class="pmrtop_contheight">
                            <div class="widget-inline-box text-center fl">
                                <p>流动人口</p>
                            <h3 class="pt6 ceeb1fd">8654</h3>
                            </div>
                            <div class="widget-inline-box text-center fl">
                                <p>重点人员</p>
                                <h3 class="pt6 c24c9ff">135622</h3>
                            </div>
                            <div class="widget-inline-box text-center fl" >
                                <p>重点人员</p>
                                <h3 class="pt6 cffff00">135622</h3>
                            </div>
                        </div>
                        <div id="pmrmidd" class="pmrmiddcont" ></div>
                    </div>
                </div> -->
                <!-- pmrtop -->
            </div>

            <!-- <div class="mrbox_bottom">
                <div class="rbottom_box1"><h2 class="tith2">高危人员年龄分析</h2>
                    <div id="prbottom_box1" class="prbottom_box1cont"></div>
                </div>
                <div class="rbottom_box2"><h2 class="tith2">宗教信仰</h2>
                    <div id="prbottom_box2" class="prbottom_box1cont"></div>
                </div>
            </div> -->
        </div>
    </div>
</body>
</html>
<script type="text/javascript">
    $(document).keyup(function (event) {
        switch (event.keyCode) {
        //13 为enter键的keyCode值，当监听到enter键的触发，立即退出全屏。
        //该按键不为固定，可以随意更换： 如 27 esc键
            case 13:
                vm.exitFullscreen();
                break;
        }
    });
    $(function () {
        new Vue({
            el: '#body1',
            data: {
                params: {
                    start: null,
                    end: null
                },
                params2: {
                    start: null,
                    end: null
                },
                dataLists: {},
                dataLists2: {},
                array1: [],
                array2: [],
                array3: [],
                myChart01: null,
                myChart02: null,
                myChart03: null,
                myChart04: null,
                myChart05: null,
                myChart06: null,
                myChart07: null,
                myChart08: null,
                myChart09: null,
                imgsrc: [],
                colors: ['ceeb1fd', 'c24c9ff', 'cffff00', 'c11e2dd']
            },
            mounted: function() {
                vm = this;
                vm.changeData('month');
                vm.myChart01 = echarts.init(document.getElementById('lpeftbot'));
                vm.myChart02 = echarts.init(document.getElementById('lpeftbot02'));
                vm.myChart03 = echarts.init(document.getElementById('prbottom_box4'));
                vm.myChart04 = echarts.init(document.getElementById('pleftbox2top'));
                vm.myChart05 = echarts.init(document.getElementById('pleftbox2midd'));
                vm.myChart06 = echarts.init(document.getElementById('pmrboxbottom'));
                vm.myChart07 = echarts.init(document.getElementById('prbottom_box3'));
                vm.myChart08 = echarts.init(document.getElementById('pleftbox2bott_cont'));
            },
            updated: function() {
                vm.showGraph();
            },
            methods: {
                // 展示数据选择
                changeData: function(val) {
                    var bgLists = document.getElementsByClassName('bg');
                    for(var i=0; i<bgLists.length; i++) {
                        bgLists[i].classList.remove('active');
                    }
                    // 本月
                    if (val === 'month') {
                        bgLists[0].classList.add('active');
                        vm.params.start = vm.setStartTime();
                        vm.params.end = vm.setEndTime();
                    }
                    // 本季
                    else if(val === 'quarter') {
                        bgLists[1].classList.add('active');
                        vm.params.start = vm.setStartTime(true, false);
                        vm.params.end = vm.setEndTime(true, false);
                    }
                    // 本年
                    else if(val === 'year') {
                        bgLists[2].classList.add('active');
                        vm.params.start = vm.setStartTime(false, true);
                        vm.params.end = vm.setEndTime(false, true);
                    }
                    vm.loadData();
                    vm.getChangeData(val);
                },
                // 起始时间
                setStartTime: function(isQuarter, isYear) {
                    var date = new Date();
                    date.setDate(1)
                    date.setHours(0);
                    date.setMinutes(0);
                    date.setSeconds(0);
                    if (isQuarter) {
                        if(date.getMonth() < 3) {
                            date.setMonth(0);
                        } else if(date.getMonth() < 6) {
                            date.setMonth(3);
                        } else if(date.getMonth() < 9) {
                            date.setMonth(6);
                        } else {
                            date.setMonth(9);
                        }
                    }
                    if(isYear) {
                        date.setMonth(0);
                    }
                    // console.log(date);
                    return formatTimeToStr(date);
                },
                // 结束时间
                setEndTime: function(isQuarter, isYear) {
                    var date = new Date();
                    date.setHours(23);
                    date.setMinutes(59);
                    date.setSeconds(59);
                    if (isQuarter) {
                        if(date.getMonth() < 3) {
                            date.setMonth(2);
                        } else if(date.getMonth() < 6) {
                            date.setMonth(5);
                        } else if(date.getMonth() < 9) {
                            date.setMonth(8);
                        } else {
                            date.setMonth(11);
                        }
                    }
                    if(isYear) {
                        date.setMonth(11);
                    }
                    switch (date.getMonth()) {
                        case 0:
                        case 2:
                        case 4:
                        case 6:
                        case 7:
                        case 9:
                        case 11:
                            date.setDate(31);
                            break;
                        case 1: 
                            if(date.getFullYear % 4 == 0 && date.getFullYear % 100 != 0 || date.getFullYear % 400 == 0) {
                                date.setDate(29);
                            } else {
                                date.setDate(28);
                            }
                            break;
                        case 3:
                        case 5:
                        case 8:
                        case 10:
                            date.setDate(30);
                            break;
                    }
                    // console.log(date);
                    return formatTimeToStr(date);
                },
                // 加载数据
                loadData: function() {
                    doApi(
                        function (res) {
                            if(res.status === 200) {
                                vm.dataLists = res.data;
                                vm.array1 = vm.dataLists.RKTJ;
                                // console.log(vm.array1[0].sum);
                            }
                        },null,null,params.serviceIp + '/PoliceVisitForm/getStatisticsRK', "get",vm.params,null,false
                    );
                },
                loadData02: function() {
                    doApi(
                        function (res) {
                            if(res.status === 200) {
                                vm.dataLists2 = res.data;
                                vm.array2 = vm.dataLists2.RKTJ;
                                // console.log(vm.array2[0].sum);
                            }
                        },null,null,params.serviceIp + '/PoliceVisitForm/getStatisticsRK', "get",vm.params2,null,false
                    );
                },
                // 全屏功能实现
                fullScreen: function() {
                    var elem = document.getElementById("content");
                    vm.requestFullScreen(elem);
                },
                requestFullScreen: function(element) {
                    var requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullScreen;
                    if (requestMethod) {
                        requestMethod.call(element);
                    } else if (typeof window.ActiveXObject !== "undefined") {
                        var wscript = new ActiveXObject("WScript.Shell");
                        if (wscript !== null) {
                            wscript.SendKeys("{F11}");
                        }
                    }
                },
                // 图形绘画
                showGraph: function() {
                    // 实有人口性别占比
                    var option01 = {
                        color: ['#4bc1ff','#fe7171'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        grid: {
                            left: 20,
                            right: 20,
                            top: 0,
                            bottom: 20
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b} : {c} ({d}%)',
                            position: 'inside'
                        },
                        legend: {
                            top: 10,
                            textStyle: {
                                fontSize: 10,
                                color: 'rgba(255,255,255,.7)'
                            },
                            data: ['男', '女']
                        },
                        series: [
                            {
                                name: '访问来源',
                                type: 'pie',
                                radius: '55%',
                                center: ['50%', '55%'],
                                label : {
                                    normal : {
                                        formatter: '{b}\n({d}%)',
                                        textStyle : {
                                            fontWeight : 'normal',
                                            fontSize : 11
                                        }
                                    }
                                },
                                data: vm.convertKey(vm.dataLists.SYRKXBZB),
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                }
                            }
                        ]
                    };
                    vm.myChart01.setOption(option01);
                    // 有无工作
                    var option02 = {
                        color: ['#17d226',  '#7bf3dc'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b} : {c} ({d}%)',
                            position: 'inside'

                        },
                        grid: {
                            left: 20,
                            right: 20,
                            top: 0,
                            bottom: 20
                        },
                        legend: {
                            top: 0,
                            textStyle: {
                                fontSize: 10,
                                color: 'rgba(255,255,255,.7)'
                            },
                            data: ['有工作', '无工作']
                        },
                        series: [
                            {
                                name: '访问来源',
                                type: 'pie',
                                radius: '55%',
                                center: ['50%', '55%'],
                                label : {
                                    normal : {
                                        formatter: '{b} \n ({d}%)',
                                        textStyle : {
                                            fontWeight : 'normal',
                                            fontSize : 11
                                        }
                                    }
                                },
                                data: [
                                    {value: 635, name: '有工作'},
                                    {value: 100, name: '无工作'}

                                ],
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                }
                            }
                        ]
                    };
                    vm.myChart02.setOption(option02);
                    // 实有人口数量分析
                    var populationValueArr = [];
                    var populationNameArr = [];
                    for(var i=0; i<vm.array1.length; i++) {
                        populationValueArr.push(vm.array1[i].sum);
                        populationNameArr.push(vm.array1[i].name);
                    }
                    var option03 = {
                        backgroundColor: 'rgba(1,202,217,.2)',
                        grid: {
                            left:60,
                            right:20,
                            top:40,
                            bottom:40
                        },
                        toolbox: {
                            feature: {
                                // dataView: {show: true, readOnly: false},
                                magicType: {show: true, type: ['line', 'bar']},
                                restore: {show: true},
                                saveAsImage: {show: true}
                            }
                        },
                        /* legend: {
                            top:10,
                            textStyle:{
                                fontSize: 10,
                                color:'rgba(255,255,255,.7)'
                            },
                            data:['男','女','总数']
                        },*/
                        xAxis: [
                            {
                                type: 'category',
                                axisLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,.2)'
                                    }
                                },
                                splitLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,.1)'
                                    }
                                },
                                axisLabel:{
                                    color:"rgba(255,255,255,.7)"
                                },
                                data: ['常住', '暂住', '重点', '总数'],
                                axisPointer: {
                                    type: 'shadow'
                                }
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                name: '',
                                // min: 0,
                                // max: 250,
                                // interval: 50,
                                axisLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,.8)'
                                    }
                                },
                                splitLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,.01)'
                                    }
                                },
                                axisLabel: {
                                    formatter: '{value} '
                                }
                            },
                            {
                                type: 'value',
                                name: '',
                                max: 25,
                                interval: 5,
                                axisLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,0)'
                                    }
                                },
                                splitLine:{
                                    lineStyle:{
                                        color:'rgba(255,255,255,0)'
                                    }
                                }
                            }
                        ],
                        series: [
                            {
                                name:'类型',
                                type:'bar',
                                barWidth:'20',
                                itemStyle: {
                                    normal: {
                                        color: new echarts.graphic.LinearGradient(
                                            0, 0, 0, 1,
                                            [
                                                {offset: 0, color: '#fffb34'},
                                                {offset: 1, color: '#032a72'}
                                            ]
                                        )
                                    }
                                },
                                label: {
                                    normal: {
                                        show: true,
                                        position: 'top',
                                        color: '#7bf3dc'
                                    }
                                },
                                data: populationValueArr
                            },
                        ]
                    };
                    vm.myChart03.setOption(option03);
                    // 实有人口民族分析
                    // for(var k=0; k<vm.dataLists.ZDRKTJ.length; k++) {
                        // importantValueArr.push(vm.dataLists.ZDRKTJ[k].sum);
                        // importantNameArr.push(vm.dataLists.ZDRKTJ[k].name);
                    // }
                    var option04 = {
                        color: ['#14f4a9'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                            }
                        },
                        grid: {
                            /*left: 10,
                            right: 10,
                            top: 40,
                            bottom: 10,
                            containLabel: true*/
                            left: '1%',
                            right: '1%',
                            bottom: '1%',
                            containLabel: true
                        },
                        toolbox: {
                            feature: {
                                // dataView: {show: true, readOnly: false},
                                magicType: {show: true, type: ['line', 'bar']},
                                restore: {show: true},
                                saveAsImage: {show: true}
                            }
                        },
                        xAxis: [
                            {
                                type: 'category',
                                axisLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.9)'
                                    }
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.01)'
                                    }
                                },
                                data: ['藏族', '回族', '彝族', '汉族', '蒙族']
                            }
                        ],
                        yAxis: [
                            {
                                axisLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.9)'
                                    }
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.21)'
                                    }
                                },
                                axisLabel: {
                                    formatter: '{value} 个'
                                },
                                type: 'value'
                            }
                        ],
                        series: [
                            {
                                name: '数量',
                                type: 'bar',
                                barWidth: 20,
                                label: {
                                    normal: {
                                        show: true,
                                        position: 'top',
                                        color: '#7bf3dc'
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        color: new echarts.graphic.LinearGradient(
                                            0, 0, 0, 1,
                                            [
                                                {offset: 0, color: 'rgba(8,151,255,0.85)'},
                                                {offset: 1, color: '#33f8ff'}
                                            ]
                                        )
                                    }
                                },
                                data: [
                                    {value: 58, name: '藏族'},
                                    {value: 35, name: '回族'},
                                    {value: 88, name: '彝族'},
                                    {value: 352, name: '汉族'},
                                    {value: 135, name: '蒙族'}
                                ]
                            },
                        ]
                    };
                    vm.myChart04.setOption(option04);
                    // 实有人口年龄结构
                    var ageNameArray = [];
                    for(var j=0; j<vm.dataLists.STRKNLJG.length; j++) {
                        ageNameArray.push(vm.dataLists.STRKNLJG[j].name);
                    }
                    var option05 = {
                        color: ['#4bc1ff', 'blue', '#3bee19', '#00ffe3', '#17fdff'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        grid: {
                            left: 20,
                            right: 20,
                            top: 0,
                            bottom: 20
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b} : {c} ({d}%)',
                            position: 'inside'

                        },
                        legend: {
                            top: 10,
                            textStyle: {
                                fontSize: 10,
                                color: 'rgba(255,255,255,.7)'
                            },
                            data: ageNameArray
                        },
                        series: [
                            {
                                name: '访问来源',
                                type: 'pie',
                                radius: '40%',
                                center: ['50%', '65%'],
                                data: vm.convertKey(vm.dataLists.STRKNLJG),
                                label : {
                                    normal : {
                                        formatter: '{b}:\n({d}%)',
                                        textStyle : {
                                            fontWeight : 'normal',
                                            fontSize : 10
                                        }
                                    }
                                },
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                }
                            }
                        ]
                    };
                    vm.myChart05.setOption(option05);
                    // 重点人口
                    var importantValueArr = [];
                    var importantNameArr = [];
                    for(var k=0; k<vm.dataLists.ZDRKTJ.length; k++) {
                        // importantValueArr.push(vm.dataLists.ZDRKTJ[k].sum);
                        importantNameArr.push(vm.dataLists.ZDRKTJ[k].name);
                    }
                    var option06 = {
                        color: ['#d2d17c', '#00b7ee', '#2ec1ac', '#e0ece4', '#1aff53', '#ffb0b0', '#fe7171', '#ffbb91', '#64958f'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        grid: {
                            left: 20,
                            right: 20,
                            top: 0,
                            bottom: 20
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b} : {c} ({d}%)',
                            position: 'inside'
                        },
                        legend: {
                            top: 10,
                            textStyle: {
                                fontSize: 15,
                                color: 'rgba(255,255,255,.7)'
                            },
                            data: importantNameArr
                        },
                        series: [
                            {
                                name: '',
                                type: 'pie',
                                // radius: '55%',
                                radius: [25, 110],
                                roseType: 'radius',

                                center: ['50%', '65%'],
                                label : {
                                    normal : {
                                        formatter: '{b}:{c}人:\n ({d}%)',
                                        textStyle : {
                                            fontWeight : 'normal',
                                            fontSize : 12
                                        }
                                    }
                                },
                                data: vm.convertKey(vm.dataLists.ZDRKTJ),
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                }
                            }
                        ]
                    };
                    vm.myChart06.setOption(option06);
                    // 宗教信仰
                    var option07 = {
                        color: ['#14f4a9'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                            }
                        },
                        grid: {
                            /*left: 10,
                            right: 10,
                            top: 40,
                            bottom: 10,
                            containLabel: true*/
                            left: '1%',
                            right: '1%',
                            bottom: '1%',
                            containLabel: true
                        },
                        xAxis: [
                            {
                                type: 'category',
                                axisLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.8)'
                                    }
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.01)'
                                    }
                                },
                                data: ['伊斯兰教', '天主教', '基督教', '佛教', '道教']
                            }
                        ],
                        yAxis: [
                            {
                                axisLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.8)'
                                    }
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,.11)'
                                    }
                                },

                                axisLabel: {
                                    formatter: '{value} 个'
                                },
                                type: 'value'
                            }

                        ],
                        series: [

                            {
                                name: '数量',
                                type: 'bar',
                                barWidth: 20,
                                label: {
                                    normal: {
                                        show: true,
                                        position: 'top',
                                        color: '#7bf3dc'
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        color: new echarts.graphic.LinearGradient(
                                            0, 0, 0, 1,
                                            [
                                                {offset: 0, color: '#1f7feb'},
                                                {offset: 1, color: '#33f8ff'}
                                            ]
                                        )
                                    }
                                },
                                data: [50, 20, 13, 31, 12,23]
                            },
                            /*{
                                name:'涉稳人员',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[120, 132, 101, 134, 290, 230, 220, 101, 134, 290, 230, 220]
                            },
                            {
                                name:'涉毒人员',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[60, 72, 71, 74, 190, 130, 110, 71, 74, 190, 130, 110]
                            },
                            ,
                            {
                                name:'在逃人员',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[120, 132, 101, 134, 290, 230, 220, 101, 134, 290, 230, 220]
                            },
                            {
                                name:'重点上访人员',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[60, 72, 71, 74, 190, 130, 110, 71, 74, 190, 130, 110]
                            },
                            {
                                name:'肇事肇祸精神病人',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[60, 72, 71, 74, 190, 130, 110, 71, 74, 190, 130, 110]
                            },
                            {
                                name:'重大刑事犯罪前科人员',
                                type:'bar',
                                stack: '搜索引擎',
                                data:[62, 82, 91, 84, 109, 110, 120, 91, 84, 109, 110, 120]
                            }*/
                        ]
                    };
                    vm.myChart07.setOption(option07);
                    // 政治面貌
                    var option08 = {
                        color: ['#7ecef4'],
                        backgroundColor: 'rgba(1,202,217,.2)',
                        grid: {
                            left: 50,
                            right: 0,
                            top: 20,
                            bottom: 0,
                            containLabel: true
                        },
                        xAxis: {
                            type: 'value',
                            axisLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0)'
                                }
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0)'
                                }
                            },
                            axisLabel: {
                                color: "rgba(255,255,255,0)"
                            },
                            boundaryGap: [0, 0.01]
                        },
                        yAxis: {
                            type: 'category',
                            axisLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,.5)'
                                }
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,.1)'
                                }
                            },
                            axisLabel: {
                                color: "rgba(255,255,255,.5)"
                            },
                            data: [ '中共党员','预备党员','共青团员','群众']
                        },
                        series: [
                            {
                                name: '2011年',
                                type: 'bar',
                                barWidth: 20,
                                itemStyle: {
                                    normal: {
                                        color: new echarts.graphic.LinearGradient(
                                            1, 0, 0, 1,
                                            [
                                                {offset: 0, color: 'rgba(230,253,139,.7)'},
                                                {offset: 1, color: 'rgba(41,220,205,.7)'}
                                            ]
                                        )
                                    }
                                },
                                label: {
                                    normal: {
                                        show: true,
                                        position: 'inside',
                                        color: '#7bf3dc'
                                    }
                                },
                                data: [100, 200, 500, 1170]
                            }
                        ]
                    };
                    vm.myChart08.setOption(option08);
                },
                // 键值转换 keyMap是要替换的键值对映射
                convertKey: function(arr) {
                    var result = arr.map(function (item) {
                        return {value: item.sum, name: item.name};
                    })
                    return result;
                },
                // 与上月或上季度，或上一年对比数据
                getChangeData: function(val) {
                    vm.array3 = [];
                    // 上月
                    if (val === 'month') {
                        vm.params2.start = vm.setStartTime2(false, false);
                        vm.params2.end = vm.setEndTime2(false, false);
                    }
                    // 上季
                    else if(val === 'quarter') {
                        vm.params2.start = vm.setStartTime2(true, false);
                        vm.params2.end = vm.setEndTime2(true, false);
                    }
                    // 上年
                    else if(val === 'year') {
                        vm.params2.start = vm.setStartTime2(false, true);
                        vm.params2.end = vm.setEndTime2(false, true);
                    }
                    vm.loadData02();
                    for(var i=0; i<vm.array1.length; i++) {
                        if(vm.array1[i].sum >= vm.array2[i].sum) {
                            if (vm.array2[i].sum === 0 && vm.array1[i].sum != 0) {
                                vm.array3.push('100%');
                                vm.imgsrc.push('./../../../css/statistics/img/iconup.png');
                            } else if(vm.array2[i].sum === 0 && vm.array1[i].sum === 0) {
                                vm.array3.push('0%');
                                vm.imgsrc.push('./../../../css/statistics/img/iconup.png');
                            } else {
                                vm.array3.push(parseInt(((vm.array1[i].sum-vm.array2[i].sum)/vm.array2[i].sum) * 10000 ) / 100 + '%');
                                vm.imgsrc.push('./../../../css/statistics/img/iconup.png');
                            }
                        } else {
                            if (vm.array2[i].sum === 0) {
                                vm.array3.push('100%');
                                vm.imgsrc.push('./../../../css/statistics/img/icondown.png');
                            } else if(vm.array2[i].sum === 0 && vm.array1[i].sum === 0) {
                                vm.array3.push('0%');
                                vm.imgsrc.push('./../../../css/statistics/img/icondown.png');
                            } else {
                                vm.array3.push(parseInt(((vm.array2[i].sum-vm.array1[i].sum)/vm.array2[i].sum) * 10000) / 100 + '%');
                                vm.imgsrc.push('./../../../css/statistics/img/icondown.png');
                            }
                        }
                    }
                    // console.log(vm.array3);
                },
                // 起始时间
                setStartTime2: function(isQuarter, isYear) {
                    var date = new Date();
                    date.setDate(1)
                    date.setHours(0);
                    date.setMinutes(0);
                    date.setSeconds(0);
                    if(date.getMonth() === 0) {
                        date.setFullYear(date.getFullYear()-1);
                        date.setMonth(11);
                    } else {
                        date.setMonth(date.getMonth()-1);
                    }
                    if (isQuarter) {
                        // console.log(date.getMonth());
                        if(date.getMonth() < 3) {
                            date.setFullYear(date.getFullYear()-1);
                            date.setMonth(9);
                        } else if(date.getMonth() < 6) {
                            date.setMonth(0);
                        } else if(date.getMonth() < 9) {
                            date.setMonth(3);
                        } else {
                            date.setMonth(6);
                        }
                    }
                    if(isYear) {
                        date.setFullYear(date.getFullYear()-1);
                        date.setMonth(0);
                    }
                    // console.log(date);
                    return formatTimeToStr(date);
                },
                // 结束时间
                setEndTime2: function(isQuarter, isYear) {
                    var date = new Date();
                    date.setMonth(date.getMonth()-1);
                    date.setHours(23);
                    date.setMinutes(59);
                    date.setSeconds(59);
                    if (isQuarter) {
                        // console.log(date.getMonth());
                        if(date.getMonth()+1 < 3) {
                            date.setFullYear(date.setFullYear()-1);
                            date.setMonth(11);
                        } else if(date.getMonth()+1 < 6) {
                            date.setMonth(2);
                        } else if(date.getMonth()+1 < 9) {
                            date.setMonth(5);
                        } else {
                            date.setMonth(8);
                        }
                    }
                    if(isYear) {
                        date.setFullYear(date.getFullYear()-1);
                        date.setMonth(11);
                    }
                    switch (date.getMonth()) {
                        case 0:
                        case 2:
                        case 4:
                        case 6:
                        case 7:
                        case 9:
                        case 11:
                            date.setDate(31);
                            break;
                        case 1: 
                            if(date.getFullYear % 4 == 0 && date.getFullYear % 100 != 0 || date.getFullYear % 400 == 0) {
                                date.setDate(29);
                            } else {
                                date.setDate(28);
                            }
                            break;
                        case 3:
                        case 5:
                        case 8:
                        case 10:
                            date.setDate(30);
                            break;
                    }
                    // console.log(date);
                    return formatTimeToStr(date);
                },
            }
        })
    })
</script>