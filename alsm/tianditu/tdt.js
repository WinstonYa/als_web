var oldHtml;
var gMap;
var xmlhttp;
var siteObjs;
var currentFea;
var webPath = "http://www.hclbs.com:9006/webgis/";
var sitesUrl = "";
var sip = "";
var slayers = "";
var siteInfoUrl = "";
//0：漫游状态；1：框选状态。
var mouseState = 0;
var regId = "";
var centerPoint = null;


function mouseOverGJ() {
    document.getElementById("menuList").style.display = "block";
}

function hiddeMenuList() {
    document.getElementById("menuList").style.display = "none";
}

//改变鼠标状态
function changeMouseState(t) {
    mouseState = t;
    adjustMouse();
}

function adjustMouse() {
    if (mouseState == 0) {
        gMap.activateClickFeatureControl();
        document.getElementById("gnssMap").style.cursor = "pointer";
    } else {

        gMap.activateRectFeatureControl();
        document.getElementById("gnssMap").style.cursor = "crosshair";
    }
}

function menuFix() {
    var sfEls = document.getElementById("menu").getElementsByTagName("li");
    for (var i = 0; i < sfEls.length; i++) {
        sfEls[i].onmouseover = function () {
            this.className += (this.className.length > 0 ? " " : "") + "sfhover";
        }
        sfEls[i].onMouseDown = function () {
            this.className += (this.className.length > 0 ? " " : "") + "sfhover";
        }
        sfEls[i].onMouseUp = function () {
            this.className += (this.className.length > 0 ? " " : "") + "sfhover";
        }
        sfEls[i].onmouseout = function () {
            this.className = this.className.replace(new RegExp("( ?|^)sfhover\\b"), "");
        }
    }
}

var globalRegID = "";

function setWPath(p, regid, point) {
    webPath = p;
    regId = regid;
    centerPoint = point;
    sitesUrl = webPath + "/GNSSService?req=getSites";
    siteInfoUrl = webPath + "/GNSSService?getSiteInfo&fourChar=";
    Geo.ImgPath = webPath + "Openlayers/img/";
}

function changeScreen() {
    //if (document.getElementById("screenHref").innerHTML == "退出全屏") {
    //    document.getElementById("screenHref").innerHTML = "全屏";
    //    document.getElementById("liScreen").style.width = "75px";
    //    document.getElementById("screenHref").style.left = "0px";
    //} else {
    //    document.getElementById("screenHref").innerHTML = "退出全屏";
    //    document.getElementById("liScreen").style.width = "90px";
    //    document.getElementById("screenHref").style.left = "-5px";
    //}
    //parent.mainFrameFull();
    var wid = document.documentElement.clientWidth - 0;
    var hei = document.documentElement.clientHeight - 40;
    document.getElementById("gnssMap").style.width = wid + "px";
    document.getElementById("gnssMap").style.height = hei + "px";
    document.getElementById("searchPanel").style.maxHeight = hei + "px";
    document.getElementById("data").style.maxHeight = hei + "px";
    document.getElementById("tuceng").style.maxHeight = hei + "px";

    changeCustomPanelWidth("searchPanel", 198);
    changeCustomPanelWidth("data", 118);
    changeCustomPanelWidth("tuceng", 118);
}

function changeCustomPanelWidth(id, displayWidth) {
    var panelDOM = document.getElementById(id);
    var searchscrollWidth = panelDOM.scrollWidth;
    var searchWidth = panelDOM.getClientRects()[0];
    if (searchWidth && searchscrollWidth !== displayWidth) {
        panelDOM.style.width = searchWidth.width - (searchscrollWidth - displayWidth) + "px";
    }
}

function selectPosition1() {
    startSel1();
}

function selectPosition2(formId, formName, name, typeCode, typeName, icon) {

    startSel2(formId, formName, name, typeCode, typeName, icon);
}

function zoomIn() {
    gMap.zoomIn();
}

function zoomOut() {
    gMap.zoomOut();
}

function requestServlet(url) {
    xmlhttp = null;
    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    if (xmlhttp != null) {
        xmlhttp.onreadystatechange = state_Change;
        xmlhttp.open("GET", url, true);
        xmlhttp.setRequestHeader("If-Modified-Since", "0");
        xmlhttp.send(null);
    }
}

function state_Change() {
    if (xmlhttp.readyState == 4) {
        if (xmlhttp.status == 200) {
            var rr = xmlhttp.responseText;
            rr = decodeURIComponent(rr);
            var jObj = eval('(' + rr + ')');
            if (jObj.hasOwnProperty('type')) {
                // 应该包含type属性。
                var type = jObj.type;
                if (type == 'getSites') {
                    addSiteFeatures(jObj.sites);
                } else if (type == 'getSiteInfo') {
                    // alert(jObj.mes);
                    if (currentFea != null
                        && jObj.fourChar == currentFea.fourChar
                        && currentFea.popup != null) {
                        updateSiteFeatur(jObj.mes);
                    }
                }
            }
        }
    }
}

function updateSiteFeatur(mes) {
    var strs = mes.split(",");
    if (strs[0] == "0") {
        document.getElementById("td_netStatus").innerHTML = "故障";
    } else if (strs[0] == "1") {
        document.getElementById("td_netStatus").innerHTML = "正常";
    }

    document.getElementById("loadtr").style.display = "none";
    document.getElementById("mestr").style.display = "block";

    document.getElementById("jindu1hz").innerHTML = "&nbsp;" + strs[1] + "%";
    document.getElementById("jindu30").innerHTML = "&nbsp;" + strs[2] + "%";
    document.getElementById("jindut1hz").style.width = "" + strs[1] + "px";
    document.getElementById("jindut30").style.width = "" + strs[2] + "px";

    document.getElementById("siteImg").style.width = "64px";
    document.getElementById("siteImg").style.height = "64px";
    document.getElementById("siteImg").style.top = "0px";
    document.getElementById("siteImg").style.left = "0px";
    document.getElementById("siteImg").src = webPath + "/" + strs[3];
    document.getElementById("siteImg").style.display = 'block';
    var ss = strs[4];
    if (ss == "-2") {

        document.getElementById("f2").style.display = "none";
        document.getElementById("ntripmes").style.display = "none";

        document.getElementById("td_streamStatus").innerHTML = "无";
        document.getElementById("td_streamFormat").innerHTML = "---";
        document.getElementById("td_streamitr").innerHTML = "---";
        document.getElementById("td_streamtt").innerHTML = "0";
        document.getElementById("td_thistt").innerHTML = "0";
        comeOutWindow();
        return;
    }
    document.getElementById("f2").style.display = "block";
    document.getElementById("ntripmes").style.display = "block";
    if (ss == "1") {
        if (strs[6] != null && strs[6] != "0") {
            document.getElementById("td_streamStatus").innerHTML = "正常(曾有中断)";
        } else {
            document.getElementById("td_streamStatus").innerHTML = "正常";
        }
    } else if (ss == "0") {
        document.getElementById("td_streamStatus").innerHTML = "已中断";
    }
    document.getElementById("td_streamFormat").innerHTML = strs[5];
    document.getElementById("td_streamitr").innerHTML = strs[6];
    document.getElementById("td_streamtt").innerHTML = strs[7];
    document.getElementById("td_thistt").innerHTML = strs[8];
    comeOutWindow();
}

function addSiteFeatures(siteArray) {
    siteObjs = [];
    var i = 0;
    for (; i < siteArray.length; i++) {
        var strs = siteArray[i].split(",");
        var sObj = new Object();
        sObj.lon = strs[0];
        sObj.lat = strs[1];
        sObj.fourChar = strs[2];
        sObj.status = strs[3];
        sObj.siteName = strs[4];
        sObj.stream_status = strs[5]
        sObj.siteid = strs[6];
        siteObjs.push(sObj);
        gMap.addSiteFeature(sObj);
    }
    gMap.checkDeleteedFeatures(siteObjs);
}

function addFFS() {
    addSiteFeatures([
        "119.0,35.0,aaaa,1,AAAA,1,1111",
        "118.0,32.0,bbbb,1,BBBB,1,1111",
        "113.0,30.0,cccc,1,CCCC,0,1111",
        "121.0,23.0,dddd,1,DDDD,1,1111",
        "119.0,33.0,ddde,1,DDDD,1,1111",
        "118.0,33.0,dddf,1,DDDD,1,1111",
        "114.0,33.2,dddg,1,DDDD,1,1111",
        "117.0,32.5,dddh,1,DDDD,1,1111",
        "116.0,23.0,dddj,1,DDDD,1,1111",
        "115.3,23.1,dddk,1,DDDD,1,1111",
        "108.3,23.7,dddl,1,DDDD,1,1111"
    ]);
}

//画点
function addSiteFeaturesObjs(objs) {
    siteObjs = [];
    var i = 0;
    for (; i < objs.length; i++) {
        siteObjs.push(objs[i]);
        gMap.addSiteFeature(objs[i]);
    }
}

////获取点弹出窗
//function getSiteFeaturesObjs() {

//}

//画图
function addSiteFeaturesObjs2(objs) {
    siteObjs = [];
    var i = 0;
    for (; i < objs.length; i++) {
        siteObjs.push(objs[i]);
        gMap.createPolygon2(objs[i]);
    }
}

//点
function getData(vType, action) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType;
    executeService(url, jsonParams, viewData, action);
}

//面
function getData2(vType, action) {
    var value = '';
    if (action == 'gnqh')
        value = '阿拉善右旗;105.26990519,40.91987373 105.23778247,40.83778232 105.26633600,40.76282930 105.34842740,40.71286062 105.26633600,40.61649245 105.18424459,40.59864649 105.12356834,40.54867781 105.01292340,40.53083185 104.97366229,40.56295458 104.90941685,40.56652377 104.79877191,40.68430709 104.43114518,40.68073790 104.47040629,40.61649245 104.54535931,40.55581619 104.52751336,40.52369347 104.53822093,40.48800155 104.58105123,40.48443236 104.58462042,40.43446368 104.55249770,40.40234096 104.63458910,40.34880309 104.60603557,40.25957330 104.64529668,40.14892836 104.50966740,40.09895968 104.42400680,40.08468291 104.32763863,40.08111372 104.21342450,40.02043747 104.27410076,39.98117636 104.22770127,39.83483951 104.30979267,39.62068802 104.25982399,39.56001176 104.24197803,39.44579763 104.09242891,39.41008589 103.94787665,39.45648538 103.81581657,39.45291619 103.34111410,39.32264070 103.01453308,39.09599704 102.61478363,39.15488870 102.46309299,39.24947227 102.32746371,39.22448793 102.27749503,39.18344223 101.82956149,39.08707406 102.06334354,38.89255312 101.93306805,38.78904657 101.77423903,38.65698648 101.66716328,38.68732461 101.60113324,38.64270972 101.54581077,38.70873976 101.30667494,38.77655440 101.32987468,38.81938470 101.32987468,38.86043040 101.24778328,38.86399959 101.22101434,38.91575287 101.18710702,38.94609099 101.21922975,39.00855185 101.13535375,38.97285993 100.96760174,38.93538342 100.96581715,38.98178291 100.90692549,39.02461321 100.86409519,38.98178291 100.83197247,39.01569023 100.82483408,39.07279729 100.87480277,39.09778163 100.84089545,39.19236521 100.83018787,39.39937832 100.68563562,39.39937832 100.51074523,39.39580912 100.49468387,39.47968512 100.32871646,39.50288487 100.29837834,39.56088423 100.30730132,39.58943776 100.30730132,39.61085291 100.22520991,39.69294432 100.10742659,39.69115972 100.03247357,39.75540517 99.92718242,39.76254355 99.81832208,39.86426551 99.68804659,39.88211147 99.45426455,39.86961930 99.41619317,39.85308204 99.38407045,39.89948153 99.34124015,39.97800375 99.34837853,40.01012647 99.50899215,40.09935626 99.56054009,40.15422988 99.75312485,40.21198408 99.86020059,40.29526521 99.95537903,40.37259770 100.05650613,40.35475174 100.15763322,40.40234096 100.28850357,40.37259770 100.44911719,40.48562209 100.63352542,40.49157075 100.86552287,40.42018692 101.09157166,40.42018692 101.21649337,40.45587883 101.37710698,40.39044365 101.50797734,40.40234096 101.60910443,40.46777614 101.73997479,40.49157075 101.91248571,40.68192763 102.23371295,40.85443855 102.44191578,40.95556564 102.65606727,41.06264139 102.80478359,41.15187118 102.94755125,41.22920366 103.07842160,41.34222806 103.03678104,41.37791997 103.00108912,41.53853359 103.00703777,41.68130125 102.89996203,41.84191487 102.89803105,42.08081217 103.44158684,41.87078566 103.85085413,41.79702237 103.9573,41.8001 104.0202,41.8045 104.0782,41.8006 104.1739,41.8185 104.5237,41.8734 104.5221,41.6623 104.93065354,41.65901363 105.00679629,41.58287088 105.23046562,41.74705369 105.16550634,41.55677612 105.19762906,41.37831655 105.30113562,41.15345748 105.29221264,41.12240552 105.38322702,41.03674492;0|额济纳旗;102.89996203,41.84191487 103.00703777,41.68130125 103.00108912,41.53853359 103.03678104,41.37791997 103.07842160,41.34222806 102.94755125,41.22920366 102.80478359,41.15187118 102.65606727,41.06264139 102.44191578,40.95556564 102.23371295,40.85443855 101.91248571,40.68192763 101.73997479,40.49157075 101.60910443,40.46777614 101.50797734,40.40234096 101.37710698,40.39044365 101.21649337,40.45587883 101.09157166,40.42018692 100.86552287,40.42018692 100.63352542,40.49157075 100.44911719,40.48562209 100.28850357,40.37259770 100.15763322,40.40234096 100.05650613,40.35475174 99.95537903,40.37259770 99.86020059,40.29526521 99.75312485,40.21198408 99.56054009,40.15422988 99.61963708,40.21713958 99.64105223,40.25640068 99.60892951,40.33849209 99.68031334,40.51338247 99.62320628,40.50267490 99.47686942,40.39202996 99.36979368,40.35633805 99.34480934,40.28852341 99.35194772,40.19929362 99.31982500,40.15646332 98.93435232,40.32064613 98.80586142,40.48839813 98.67380134,40.55978196 98.19196048,40.53836681 98.17411452,40.56335115 98.42752712,40.82390213 98.42038874,40.88814758 98.33211073,40.92146003 97.96805320,41.09099663 97.61648784,41.44702348 97.61470324,41.48093080 97.83420852,41.65225200 97.83420852,41.66652876 97.81279337,41.70186376 97.18312850,42.78301152 98.14681021,42.65808982 99.34248936,42.59265464 99.56258951,42.58670599 99.98494384,42.64619252 100.26453050,42.63697210 100.32401703,42.69407917 100.83798061,42.67980240 101.05927048,42.61555696 101.55181891,42.52037851 101.78738555,42.50372229 102.08339050,42.21580751 102.42127396,42.14680314 102.54262647,42.16345936 102.72108605,42.14918260 102.89803105,42.08081217;0|阿拉善左旗;104.24197803,39.44579763 104.25982399,39.56001176 104.30979267,39.62068802 104.22770127,39.83483951 104.27410076,39.98117636 104.21342450,40.02043747 104.32763863,40.08111372 104.42400680,40.08468291 104.50966740,40.09895968 104.64529668,40.14892836 104.60603557,40.25957330 104.63458910,40.34880309 104.55249770,40.40234096 104.58462042,40.43446368 104.58105123,40.48443236 104.53822093,40.48800155 104.52751336,40.52369347 104.54535931,40.55581619 104.47040629,40.61649245 104.43114518,40.68073790 104.79877191,40.68430709 104.90941685,40.56652377 104.97366229,40.56295458 105.01292340,40.53083185 105.12356834,40.54867781 105.18424459,40.59864649 105.26633600,40.61649245 105.34842740,40.71286062 105.26633600,40.76282930 105.23778247,40.83778232 105.26990519,40.91987373 105.38322702,41.03674492 105.39571919,41.00462220 105.59559391,40.89040807 105.69910047,40.83508560 105.78654566,40.81367045 105.82223758,40.81545505 105.85792949,40.79760909 106.12561885,40.75656339 106.15417239,40.74228662 106.18986430,40.74764041 106.20771026,40.71908688 106.24697136,40.71730228 106.25767894,40.67625658 106.30229383,40.64591845 106.34869332,40.65305683 106.48075341,40.61201113 106.52001452,40.54598109 106.38795443,40.54776568 106.34333954,40.58345760 106.29515545,40.58524219 106.28623247,40.56561164 106.22377162,40.56561164 106.27195571,40.48173564 106.35940090,40.40017961 106.44684609,40.41445638 106.48610720,40.38947204 106.54499886,40.43587153 106.59853673,40.45193289 106.68598192,40.45568054 106.83588796,40.45211135 106.84481094,40.43961918 106.82161120,40.40928105 106.78235009,40.36823535 106.73773520,40.34503561 106.78056550,40.27008258 106.84838013,40.26115961 106.90191801,40.26472880 106.91262558,40.24866743 106.86979528,40.19691416 106.82874958,40.16836063 106.81268822,40.15765305 106.76807333,40.11660735 106.77878090,40.07734624 106.76985792,40.04343892 106.79484226,40.00721163 106.76450413,39.98579648 106.77164252,39.96081214 106.81447281,39.93404320 106.82696499,39.86622856 106.82696499,39.79127554 106.86087230,39.76093742 106.84302635,39.73952227 106.85194933,39.71096873 106.76271954,39.67349222 106.70382788,39.64136950 106.71275086,39.57355486 106.76985792,39.53607835 106.84838013,39.51823239 106.84659554,39.48789426 106.82874958,39.46647912 106.80554984,39.44684856 106.74487358,39.43971018 106.68955111,39.44327937 106.59853673,39.36654175 106.51287613,39.26303520 106.46647664,39.26660439 106.44684609,39.28088116 106.27552490,39.27195818 106.28087868,39.17202082 106.27374030,39.13454431 106.22734081,39.12740592 106.17380294,39.14703648 106.12561885,39.12312289 106.09171153,39.06244664 106.07565017,38.97321685 105.97749741,38.84829515 105.92039034,38.77691132 105.88112924,38.68589693 105.85436030,38.61808229 105.87042166,38.58595957 105.85257570,38.55740604 105.85614489,38.52885251 105.83294515,38.45925327 105.82937596,38.38786944 105.82759136,38.32540859 105.85792949,38.29863965 105.85436030,38.23974799 105.77762268,38.19691770 105.76869970,38.07734978 105.84186813,37.99775681 105.79546864,37.94778813 105.79368404,37.89781945 105.80617621,37.86391213 105.76156132,37.78717451 105.61700906,37.76397477 105.60273230,37.70151391 105.41624204,37.69794472 105.36627336,37.70508311 105.26276681,37.68009877 105.19495217,37.65332983 105.05396910,37.58194600 104.90049387,37.56231545 104.84874059,37.55160787 104.79877191,37.52483894 104.40794544,37.50699298 104.26553470,37.40884021 104.12633623,37.44631672 103.66947972,37.77825153 103.40357495,37.84963536 103.34646789,38.01560277 103.37323682,38.08877119 103.55526559,38.14587826 103.48388176,38.33683000 103.40357495,38.39393707 103.89076959,38.64199588 104.03532185,38.88719933 104.17808951,38.93716802 104.20485844,39.09778163 104.05673700,39.28694878 104.09242891,39.41008589;0';
    if (action == 'xz')
        value = '苏和达拉;98.668951,40.976684 98.309054,40.954893 98.251563,40.628045 98.627558,40.571951|永红;98.668951,40.976684 98.309054,40.954893 97.991701,41.213293 98.534421,41.307003 98.685049,41.272312|呼木格勒;99.010451,40.999338 99.034598,40.581596 98.627558,40.571951 98.668951,40.976684|嘎拉巴特尔;98.16599363,42.65703998 98.21951546,42.16678598 98.12051795,42.01519758 98.10243405,42.01538794 98.05812849,42.01556639 98.04000153,42.00971160 97.97246789,41.98314624 97.95551423,41.98195651 97.87253053,41.96351569 97.80709535,41.96262339 97.75415234,41.95310554 97.66448256,41.95651652 97.18312850,42.78301152;0;98.0251;42.0922|吉日嘎拉;98.88317385,42.61779131 98.55145895,42.00085611 98.53759807,42.00436563 98.51875274,42.00587326 98.48256971,42.01024538 98.46319671,42.01099919 98.43289341,42.00707936 98.40470080,42.00572250 98.38284021,42.00692860 98.33361621,42.00557174 98.30647893,42.00255648 98.26125014,42.00210420 98.21749060,42.00148465 98.19608231,42.00721363 98.16427139,42.00510295 98.12051795,42.01519758 98.21951546,42.16678598 98.16599363,42.65703998;0;98.43622135;42.16863428|宝勒德巴特尔;99.24337348,42.59807890 99.24812373,42.46229124 99.08521588,41.91926506 99.01764199,41.92109641 98.97290813,41.92395176 98.93674032,41.93251782 98.89690814,41.93703879 98.86250666,41.94888498 98.82235218,41.96826046 98.79062303,41.96908717 98.74795720,41.97119785 98.67687261,41.98763098 98.62395492,41.98989242 98.59395315,41.99094776 98.55145895,42.00085611 98.88317385,42.61779131;0;98.84062028;42.23767425|苏都;99.56258951,42.58670599 99.75019000,42.09109532 99.66235299,41.87900106 99.61251896,41.88378621 99.57819542,41.88949716 99.53177213,41.90353598 99.48775210,41.91519534 99.43231066,41.92066810 99.40078280,41.92780649 99.38031944,41.92780649 99.33249227,41.92019221 99.30108339,41.91686097 99.27205396,41.91091231 99.24426186,41.91305383 99.22641590,41.91091231 99.19929005,41.90710518 99.15693564,41.90781901 99.11577097,41.90734312 99.09411787,41.91709891 99.08521588,41.91926506 99.24812373,42.46229124 99.24337348,42.59807890;0;99.53174235;42.22018787|斯琴图;105.06615325,41.15477444 105.26388520,41.23438081 105.30113562,41.15345748 105.29221264,41.12240552 105.32648896,41.09014545 105.22428678,40.97904232 105.06795619,40.81105238 104.94157809,40.56473703 104.90941685,40.56652377 104.79877191,40.68430709 104.76883689,40.68401646 104.72602765,40.73145941 104.73554549,40.79094593 104.69985358,40.84805300 104.69390492,40.88660026 104.64036705,40.89968730 104.61181352,40.91872299 104.65345409,40.92586137 104.62965948,40.97701978 104.65874441,41.03263708 104.61716041,41.11138476;0;104.8347208;41.06809047|布音乌力吉;105.26990519,40.91987373 105.23778247,40.83778232 105.26633600,40.76282930 105.34842740,40.71286062 105.26633600,40.61649245 105.18424459,40.59864649 105.12884883,40.55302645 105.08176101,40.54193469 105.01292340,40.53083185 104.97366229,40.56295458 104.94157809,40.56473703 105.06795619,40.81105238 105.32648896,41.09014545 105.38322702,41.03674492;0;105.11694452;40.72992246|恩图格日勒;104.50252057,41.40075515 104.46680917,41.53029205 104.37401019,41.61452497 104.48255714,41.86411298 104.53566301,41.87316512 104.52138624,41.70660285 104.52614517,41.65425471 104.68318959,41.64235740 104.93065354,41.65901363 105.00679629,41.58287088 104.84833194,41.36477675;0;104.69975571;41.47340567|敖登扣;104.37401019,41.61452497 104.46680917,41.53029205 104.50252057,41.40075515 104.15405469,41.34489799 104.06553874,41.56832938 104.04198208,41.60759049 104.02223067,41.67305972 103.97757812,41.79928935 104.11687787,41.80178129 104.48255714,41.86411298;0;104.18814311;41.65289902|庆格勒;104.72602765,40.73145941 104.76883689,40.68401646 104.43342826,40.67700195 104.35364200,40.75204174 104.33936523,40.77702608 104.30248359,40.82937423 104.22991003,40.81628719 104.21920245,40.84959964 104.15971593,40.91182255 104.15257755,40.97761465 104.09071156,41.07993147 103.90754065,41.28801534 103.90513750,41.30643946 103.93121817,41.30380470 103.95939865,41.30654067 103.96798084,41.30737389 103.99253688,41.30416162 104.03679485,41.28845718 104.09782803,41.28381723 104.15405469,41.34489799 104.50252057,41.40075515 104.56874528,41.20306858 104.65874441,41.03263708 104.62965948,40.97701978 104.65345409,40.92586137 104.61181352,40.91872299 104.64036705,40.89968730 104.69390492,40.88660026 104.69985358,40.84805300 104.73554549,40.79094593;0;104.49821088;41.02042581|孟根阿古拉;104.09782803,41.28381723 104.03679485,41.28845718 103.99253688,41.30416162 103.96798084,41.30737389 103.93121817,41.30380470 103.90513750,41.30643946 103.90325762,41.32085190 103.78190511,41.45362582 103.48780373,41.62523255 103.65769725,41.62251996 103.86824951,41.64630935 103.86890516,41.79734529 103.97757812,41.79928935 104.02223067,41.67305972 104.04198208,41.60759049 104.06553874,41.56832938 104.15405469,41.34489799;0;103.79535079;41.61127248|呼毕斯哈拉图;103.38803821,41.89147651 103.86890516,41.79734529 103.86824951,41.64630935 103.65769725,41.62251996 103.48780373,41.62523255;0;103.72669844;41.7713048|那仁孟克;103.86554505,41.31772455 103.80543986,41.34352980 103.75332966,41.35923424 103.71392579,41.38136323 103.64703914,41.41966066 103.62419632,41.42572828 103.58100910,41.44071889 103.54032032,41.45463873 103.50627023,41.47009333 103.48092897,41.47509020 103.44416630,41.49008080 103.42189454,41.49472075 103.32945248,41.53897873 103.31696031,41.55468317 103.29575931,41.57513464 103.26399351,41.59726363 103.22794467,41.62902943 103.17915765,41.65765247 103.15593411,41.68430243 103.14279948,41.69515278 103.11147399,41.71430281 103.18366410,41.74623254 103.21958948,41.95656403 103.38803821,41.89147651 103.48780373,41.62523255 103.78190511,41.45362582 103.90325762,41.32085190 103.90513750,41.30643946;0;103.37177328;41.77038112|朱有海;103.08529267,41.74019121 103.04379487,41.75580048 102.95545024,41.79071193 103.04508121,41.81268649 103.06764226,42.01527547 103.21958948,41.95656403 103.18366410,41.74623254 103.11147399,41.71430281;0;103.10098796;41.83372241|哈嗒布和;102.92648586,41.80212912 102.89996203,41.84191487 102.89803105,42.08081217 103.06764226,42.01527547 103.04508121,41.81268649 102.95545024,41.79071193;0;102.96819263;41.96039317|豪斯巴雅尔;102.88455420,41.81288851 102.82494870,41.83787285 102.76034634,41.85857416 102.74142962,41.87106633 102.70225252,41.91462798 102.70786400,41.93370587 102.73927289,41.99747543 102.82073572,42.11067860 102.89803105,42.08081217 102.89996203,41.84191487 102.92648586,41.80212912;0;102.80054475;41.94349161|哈斯乌拉;102.55434955,42.01102285 102.43194170,42.04312539 102.42127396,42.14680314 102.54262647,42.16345936 102.72108605,42.14918260 102.82073572,42.11067860 102.73927289,41.99747543;0;102.67137817;42.11984299|豪斯巴雅尔;102.70225252,41.91462798 102.68512040,41.92747707 102.64347983,41.94151589 102.58613482,41.96650023 102.55329826,41.98220467 102.49595325,41.99410198 102.45283741,41.99433992 102.42462985,41.99365451 102.43194170,42.04312539 102.55434955,42.01102285 102.73927289,41.99747543 102.70786400,41.93370587;0;102.80054475;41.94349161|恩克巴雅尔;102.43194170,42.04312539 102.42462985,41.99365451 102.40691382,41.98981895 102.38097769,41.97982521 102.34124069,41.96221720 102.31766679,41.95545096 102.27842292,41.94960606 102.24679853,41.95880283 102.21551435,41.97045460 102.17069281,41.97667822 102.17098284,42.06946732 102.15746120,42.20068039 102.42127396,42.14680314;0;102.27462289;42.09611557|巴音都仁;102.08742475,41.99391774 102.07369802,41.99551387 102.02645251,41.99535426 101.98463385,42.00094072 101.90066997,42.00199097 101.83731682,42.01121138 101.78392766,42.00793963 101.72450106,42.01047978 101.77463939,42.03595131 101.83602949,42.08591999 102.01234755,42.20870018 102.08339050,42.21580751 102.15746120,42.20068039 102.17098284,42.06946732 102.17069281,41.97667822 102.15534017,41.97811603;0;101.94334347;42.10700184|哈斯巴根;101.72450106,42.01047978 101.68012368,42.01745747 101.62605043,42.02667788 101.53979496,42.02638045 101.52284130,42.01826054 101.50945684,41.99981972 101.49577494,41.99476336 101.45389642,41.99149160 101.40541490,41.98851728 101.37924083,41.97453794 101.35723082,41.95639455 101.31969143,41.94465954 101.27322351,42.17507047 101.51123306,42.15587615 101.83602949,42.08591999 101.77463939,42.03595131;0;101.36292353;42.12952318|呼格吉勒图;101.18853877,42.59057757 101.55181891,42.52037851 101.78738555,42.50372229 102.08339050,42.21580751 102.01234755,42.20870018 101.83602949,42.08591999 101.51123306,42.15587615 101.27322351,42.17507047;0;101.32199131;42.30499579|敖云其木格;101.22959099,42.38915422 101.27322351,42.17507051 101.31969144,41.94465959 101.26740617,41.92427187 101.25161250,41.90776436 101.23703830,41.89378503 101.21532572,41.88605178 101.15494689,41.87950826 101.12152609,41.87210416 101.11511176,41.87009683 101.10035910,41.86593277 101.09076093,41.86523150 101.07696662,41.86568888 101.06316575,41.86860372 101.05403457,41.87264880 101.03761629,41.88008462 101.03125123,41.88222613 101.01846162,41.88549789 101.01182772,41.88674471 100.99858123,41.88698505 100.94775078,41.88774679 100.94056402,41.88734197 100.87564097,41.87698190 100.89233129,41.96522188 100.94515526,42.12313573 100.96074080,42.16846751 101.01784786,42.21308240 101.01784786,42.32372734 100.83798061,42.67980245 101.18853878,42.59057762;0;101.15458478;42.250295|根登;100.79646625,41.87143157 100.75052556,41.76390028 100.42981885,41.73541394 100.43306990,41.78279164 100.44681684,42.00604268 100.54976532,41.99718702 100.61155489,41.99169334 100.79347483,41.97388771;0;100.579;41.8229|乌吉木草;100.60441651,42.55770763 100.52140026,42.68859630 100.83798061,42.67980240 101.01784786,42.32372729 101.01784786,42.21308236 100.96074079,42.16846746 100.89233129,41.96522188 100.87564097,41.87698190 100.80516612,41.87385700 100.79646625,41.87143157 100.79347483,41.97388771 100.61155489,41.99169334 100.70673333,42.14606087;0;100.82305987;42.26471607|嘎拉巴特尔;100.29557261,41.78388775 100.24178131,41.80485723 100.24472309,41.85268829 100.25701520,42.02328068 100.34599795,42.01500644 100.44681684,42.00604268 100.43306990,41.78279164;0;100.3542189;41.9392125|达布希拉图;100.33791687,42.11488993 99.98494384,42.64619252 100.26453050,42.63697210 100.32401703,42.69407917 100.52140026,42.68859630 100.60441651,42.55770763 100.70673333,42.14606087 100.61155489,41.99139591 100.34599795,42.01500644;0;100.52723337;42.10783092|满都格日勒;99.98494384,42.64619252 100.33791687,42.11488993 100.34599795,42.01500644 100.25701520,42.02328068 100.24472309,41.85268829 100.22222033,41.85137820 100.16832554,41.85375766 100.09384841,41.85066436 100.06455725,41.85827864 100.00935375,41.85756480 99.98294173,41.85970631 99.91660236,41.87041389 99.86092297,41.87231746 99.80000877,41.88064557 99.75008768,41.87945584 99.71391987,41.88112146 99.66235299,41.87900106 99.75019000,42.09109532 99.56258951,42.58670599;0;100.26427898;42.14208867|巴音别力格;105.06615325,41.15477444 104.61716041,41.11138476 104.56874528,41.20306858 104.50252057,41.40075515 104.84833194,41.36477675 105.00679629,41.58287088 105.23046562,41.74705369 105.16550634,41.55677612 105.19762906,41.37831655 105.26388520,41.23438081;0;104.9354604;41.35213056';
    if (action == 'jtb')
        value = '银根;104.44879366,41.86384908 104.38463352,41.60062203 104.42359546,41.54082326 104.61179700,41.16825535 104.63755578,41.08323893 104.60215004,41.02714813 104.62149908,41.00781262 104.60763942,40.98811402 104.62636299,40.95953682 104.71143104,40.80185018 104.68277283,40.72524900 104.69448668,40.72465020 104.70710851,40.70108858 104.85006634,40.57230120 104.97188423,40.55633520 105.01746123,40.52256386 105.09298878,40.52273185 105.15969651,40.52300885 105.22632937,40.54695812 105.29054547,40.53195745 105.39231259,40.59973041 105.23412807,40.81572153 105.28840249,40.87716592 105.31088323,40.90185099 105.41517406,40.95735542 105.41403736,40.97619000 105.40588108,40.99998641 105.39573140,41.01651438 105.39187314,41.02537367 105.37416782,41.05619055 105.37245340,41.06160345 105.37459246,41.06217309 105.37858379,41.06320619 105.38414077,41.07079028 105.38685050,41.07876722 105.38599703,41.08223140 105.37502780,41.09010954 105.37189371,41.09430962 105.37275293,41.09812311 105.35718619,41.10835012 105.35131183,41.11173549 105.34657650,41.11579058 105.34600450,41.12578809 105.33433471,41.15243246 105.31427947,41.19509454 105.26793407,41.25813065 105.23990530,41.29375260 105.22467711,41.34967107 105.21369878,41.38161144 105.21108725,41.39030001 105.20353984,41.44944205 105.20007825,41.50827041 105.19859964,41.55318925 105.19456641,41.58087187 105.20006275,41.63321024 105.20872323,41.66174172 105.21740150,41.67476576 105.22867784,41.74832272 105.00647760,41.58154226 104.91698720,41.65462799 104.68256763,41.64554549 104.51878071,41.66114728 104.52540577,41.87465542 104.51993877,41.87482893 104.50666753,41.86602554 104.50666102,41.87289837 104.44879366,41.86384908|乌力吉;103.41387467,41.87996983 103.44273734,41.64158998 103.72490038,41.45881823 103.82972593,41.35834036 103.82284928,41.27418144 104.19849301,40.98242111 104.19274656,40.95009990 104.22264553,40.89284978 104.22148210,40.86494594 104.27459225,40.85997259 104.49167204,40.61811774 104.53895846,40.57702668 104.51945099,40.55576837 104.51600983,40.52858586 104.54815576,40.52987534 104.62412282,40.52702194 104.79603540,40.47813850 104.81211660,40.51956746 104.80981258,40.54585543 104.84557715,40.57368051 104.70710851,40.70108858 104.69448668,40.72465020 104.68120699,40.72873114 104.70869413,40.80471913 104.62406341,40.96478762 104.60763942,40.98811402 104.61717420,41.01102756 104.60215004,41.02714813 104.63755578,41.08323893 104.61179700,41.16825535 104.42359546,41.54082326 104.38463352,41.60062203 104.44879366,41.86384908 104.07584573,41.80519543 103.85433263,41.80051815 103.80790202,41.81190860 103.74266519,41.82575293 103.61302810,41.84658109 103.41445072,41.88232346 103.41387467,41.87996983|黑鹰山;97.77473372,42.72087439 97.85038777,42.02133766 98.75865369,42.01376629 98.86913007,42.03968590 98.83717761,42.62414359 98.55815184,42.63631031 98.19694058,42.65393210 97.77703338,42.72426570 97.77473372,42.72087439|算井子;97.18372056,42.80052078 97.46155284,42.29792727 97.48217736,42.26070349 97.75825827,41.80639658 97.84351092,41.65498526 97.75597199,41.58931268 97.50064240,41.45986040 97.50756285,41.42179712 97.56088743,41.39369469 97.79763702,41.22723520 98.51746553,41.38145667 98.88525455,41.55445643 98.83906984,41.73074512 98.86913007,42.03968590 98.75865369,42.01376629 97.85038777,42.02133766 97.77473372,42.72087439 97.72644082,42.72023850 97.66654241,42.72773620 97.50694462,42.75060176 97.49625651,42.75037884 97.18372056,42.80052078|马鬃山;99.22843469,42.58651423 99.23305015,42.46744499 99.15346164,42.16645504 99.12541710,41.90546438 99.10242820,41.71415812 99.11855734,41.51695517 99.19376338,41.38486526 99.35925736,41.29288599 99.44819703,41.18391865 99.44457863,41.07332274 99.44327456,41.06584118 99.44397552,41.06863785 99.43849919,41.05688154 99.42781605,41.04165926 99.43086078,41.02848530 99.38943301,40.90024596 99.38815344,40.88791437 99.38843850,40.88552099 99.40256763,40.87917825 99.41746556,40.86761131 99.41732018,40.86564811 99.41602503,40.86335536 99.41458561,40.85964283 99.41083895,40.83649911 99.40725625,40.83079990 99.41302696,40.77672733 99.40615076,40.76794454 99.40271705,40.76266707 99.41761081,40.67796522 99.42395296,40.66746322 99.45289333,40.64221762 99.45520862,40.63430882 99.45462106,40.62424505 99.48351022,40.57506997 99.48986406,40.54753197 99.48699624,40.51988477 99.48469239,40.51569801 99.48094646,40.51238455 99.48639077,40.48082759 99.51421846,40.46569157 99.31209900,40.43522579 98.31485327,40.50883044 98.32055261,40.89539938 98.31939905,40.91368530 98.29544755,40.91947816 98.22714506,40.94523210 98.21188980,40.96242204 98.19211777,40.97261494 98.15452553,41.00269556 98.08865325,41.04362384 98.05095744,41.05969746 98.02601462,41.07281514 98.00701005,41.08878162 97.95943209,41.14529215 97.79763702,41.22723520 98.51746553,41.38145667 98.88525455,41.55445643 98.83906984,41.73074512 98.86913007,42.03968590 98.83717761,42.62414359 99.22843469,42.58651423|赛罕陶来;99.44819703,41.18391865 99.71004976,41.00304752 99.86761013,41.22758380 100.20433783,41.32244697 100.36492727,41.32630723 100.39828271,41.34698750 100.43989549,41.35003484 100.76401755,41.64776965 100.86985098,41.92603899 100.93664539,42.25107871 100.98917687,42.32737158 100.99603690,42.38013444 100.85025175,42.66948833 100.31932303,42.68723356 100.26437674,42.64050404 99.96902560,42.64846788 99.50358202,42.56637576 99.22843469,42.58651423 99.23305015,42.46744499 99.15346164,42.16645504 99.12541710,41.90546438 99.10242820,41.71415812 99.11855734,41.51695517 99.19376338,41.38486526 99.35925736,41.29288599 99.44819703,41.18391865|苏泊淖尔;100.84937696,42.67167488 101.56834353,42.52601532 101.71442717,42.51127410 101.80068322,42.50358159 102.07720784,42.22557264 101.99072992,42.20724262 101.88738453,42.17148551 101.80650920,42.10171479 101.71446996,42.05707505 101.75604296,41.92100789 101.56519108,41.61014578 101.53077201,41.43683417 101.47987987,41.37476774 101.35787563,41.29848510 101.23857249,41.37485114 101.16275132,41.60589906 100.76401755,41.64776965 100.86985098,41.92603899 100.93321673,42.26043589 100.98917687,42.32737158 100.99603690,42.38013444 100.84937696,42.67167488|温图髙勒;102.07720784,42.22557264 102.45272113,42.14226121 102.54150944,42.16085518 102.62325063,42.15796069 102.70708583,42.15094729 102.90812798,42.06756411 102.85309995,41.90231099 102.88515119,41.76867645 102.85998955,41.55621887 102.90122683,41.53595976 102.82319634,41.40049372 102.58894214,41.24637172 102.41577992,41.09726777 102.10550501,40.91745419 101.66869918,41.22403844 101.53538845,41.21342909 101.47987987,41.37476774 101.53077201,41.43683417 101.56519108,41.61014578 101.75834791,41.92616084 101.71446996,42.05707505 101.80650920,42.10171479 101.88738453,42.17148551 101.99072992,42.20724262 102.07720784,42.22557264|古日乃;99.69163569,40.17457556 99.48639077,40.48082759 99.48699624,40.51988477 99.48986406,40.54753197 99.48351022,40.57506997 99.46157535,40.62416723 99.45289333,40.64221762 99.41761081,40.67796522 99.40271705,40.76266707 99.41302696,40.77672733 99.41083895,40.83649911 99.41746556,40.86761131 99.38815344,40.88791437 99.38943301,40.90024596 99.43086078,41.02848530 99.42781605,41.04165926 99.43849919,41.05688154 99.44384654,41.06879925 99.44819703,41.18391865 99.71004976,41.00304752 99.86761013,41.22758380 100.20433783,41.32244697 100.36492727,41.32630723 100.39828271,41.34698750 100.43989549,41.35003484 100.76401755,41.64776965 101.16275132,41.60589906 101.23857249,41.37485114 101.35787563,41.29848510 101.47987987,41.37476774 101.53538845,41.21342909 101.66869918,41.22403844 102.10550501,40.91745419 101.90348018,40.72948609 101.62750219,40.70131139 101.54003314,40.52276660 101.42923561,40.51211155 101.38331738,40.48026152 101.08891404,40.48426707 100.78605409,40.49098896 100.53326619,40.55087522 100.35357765,40.54028438 100.16506143,40.49818591 100.04546332,40.43496742 99.93090833,40.28042838 99.87106233,40.24878821 99.69163569,40.17457556|塔木素;101.53085087,40.53315196 101.62750219,40.70131139 101.90806028,40.74004944 102.10550501,40.91745419 102.40431296,41.10588672 102.57506793,41.23785261 102.82319634,41.40049372 102.90122683,41.53595976 102.85998955,41.55621887 102.88515119,41.76867645 102.85309995,41.90231099 102.90812798,42.06756411 102.99721310,42.03531548 102.98630773,41.55007194 102.86023055,41.24748938 103.02187249,41.03025316 103.44440810,40.99392563 103.68627599,40.94336641 103.77131958,40.89457497 103.89409181,40.80678281 103.98589719,40.78768152 104.00948830,40.78345444 104.20769562,40.75841402 104.08223624,40.66291981 104.11906665,40.55072188 104.05027393,40.45740526 103.93568547,40.49111599 103.86652357,40.46699674 103.87347235,40.36679294 103.85273873,40.28241202 103.82747616,40.24330565 103.82291243,40.13566371 103.68732961,40.14251074 103.57937720,40.08097273 103.54488496,40.06844424 103.45032168,40.03638755 103.19996356,40.01342791 102.92439517,40.03523790 102.89214165,40.03017952 102.89440799,40.21023560 102.57973874,40.30312698 102.23922286,40.30810078 101.92634847,40.45298317 101.54003314,40.52276660 101.53085087,40.53315196|纳林高勒;101.02149741,41.98401079 100.99809166,41.94680721 101.02389349,41.91518491 101.06922208,41.92045274 101.13390292,41.93693443 101.13527692,41.95302497 101.07641275,41.97917667 101.05723543,41.98430821 101.02149741,41.98401079|策克口岸边境派出所;101.22550428,42.59511532 101.36874171,42.56564158 101.33176509,42.49006484 101.22825695,42.51217815 101.22550428,42.59511532|阿拉腾敖包;102.99721310,42.03531548 103.41387467,41.87996983 103.44273734,41.64158998 103.72490038,41.45881823 103.82972593,41.35834036 103.82284928,41.27418144 104.19849301,40.98242111 104.19274656,40.95009990 104.22264553,40.89284978 104.22148210,40.86494594 104.27926013,40.86133990 104.49167204,40.61811774 104.53895846,40.57702668 104.51945627,40.55051116 104.51600983,40.52858586 104.54813224,40.49127133 104.52863840,40.46900536 104.56877807,40.42398406 104.61949190,40.36374920 104.58604554,40.28417646 104.62183801,40.15500567 104.48936932,40.10201965 104.31234132,40.08093147 104.20314457,40.02367960 104.23999848,39.99617958 104.18022384,39.86931142 104.14228028,39.92847573 104.04115540,39.99034627 104.01705960,40.02767452 103.96537024,40.06890839 103.94255533,40.08451823 103.89432076,40.12513107 103.82291243,40.13566371 103.82747616,40.24330565 103.85043790,40.27975554 103.87347235,40.36679294 103.86652357,40.46699674 103.93568547,40.49111599 104.05027393,40.45740526 104.11675043,40.55250603 104.08223624,40.66291981 104.20769562,40.75841402 104.00948830,40.78345444 103.98589719,40.78768152 103.89409181,40.80678281 103.77131958,40.89457497 103.68627599,40.94336641 103.44440810,40.99392563 103.02187249,41.03025316 102.86023055,41.24748938 102.98630773,41.55007194 102.99039405,41.79312921 102.99039288,41.81360251 102.99721310,42.03531548';
    viewData2(value, action);
    return;
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType;
    executeService(url, jsonParams, viewData2, action);
}

function getDataLw() {
    var lwData = null;
    top.doApi(function (res) {
        if (res.status === 200) {
            lwData = res.data;
            top.doApi(function (res) {
                if (res.status === 200) {
                    if (!lwData) {
                        lwData = res.data;
                    } else {
                        lwData.concat(res.data);
                    }
                    viewData3(lwData, "lw");
                }
            }, null, null, top.params.serviceIp + '/PatrolRouteInfo/getListByIsValid', 'get', {isValid: 1})
        }
    }, null, null, top.params.serviceIp + '/VisitRouteInfo/getListByIsValid', 'get', {isValid: 1})
}

function getDataygjc(vType, action, syear, stest) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&syear=" + syear + "&stest=" + stest;
    executeService(url, jsonParams, viewData2, action);
}

function getData3(vType, action, id) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&bdzyid=" + id;
    executeService(url, jsonParams, viewData, action);
}

//图片数据
function getPhotosData(vType, action, resolution) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?action=" + vType + "&resolute=" + resolution + "";
    executeService(url, jsonParams, viewData, action);
}

//本地资源名字
function getData4(vType, action, id) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&bdzyid=" + id;
    executeService(url, jsonParams, bdzyName, action);
}

//巡护路线
function getData5(vType, action, id) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&XHID=" + id;
    executeService(url, jsonParams, xhlxData, action);
}

//巡护路线
function getData5_1(vType, action, id) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&XHID=" + id;
    executeService(url, jsonParams, xhlxData3, action);
}

function getData6(vType, action, id) {
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&XHID=" + id;
    executeService(url, jsonParams, xhlxData2, action);
}

function xhlxData(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        return;
    }
    gMap.createXHLXPolygon(json, action);
}

function xhlxData2(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        removeAllPt("xhlxbyid");
        return;
    }
    gMap.createXHLXPolygon2(json, action);
}

function xhlxData3(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        return;
    }
    gMap.removeAllPt("photo3");
    gMap.removeAllPt("photo4");
    gMap.createXHLXPolygon3(json, action);
}

var name = null;

function bdzyName(value, action) {
    name = value;
}

function executeService(url, json, func, action) {
    var value = "504;系统管理员;40.05431417909795;116.41081541812979;2019-09-11 11:40:10;0 ;30.0 ;54 ;0|529;根登;41.82282295836701;100.57904561873835;2019-09-30 18:28:24;912.426058361307 ;4.9 ;54 ;0|511;敖登扣;41.877628617434915;115.28232689209439;2019-08-15 00:23:15;1444.28125 ;4.0 ;54 ;1|535;吉日嘎拉;42.00729542773374;98.43591284174646;2019-09-28 15:25:13;0 ;52.999996 ;54 ;1|509;呼毕斯哈拉图;41.62967854914999;103.61667009001333;2019-09-30 20:32:36;991 ;5.4 ;54 ;0|510;孟根阿古拉;40.020197733755914;116.44761141302425;2019-09-11 16:08:15;3 ;39.0 ;54 ;1|516;布音乌力吉;40.83318787321786;105.18983743443843;2019-09-15 12:47:34;0 ;4000.0 ;54 ;0|515;斯琴图;38.836444202809695;105.64841758068894;2019-09-21 22:24:48;0 ;470.0 ;54 ;1|531;敖云其木格;41.958052722064565;101.05869881638586;2019-09-24 11:53:21;0 ;30.0 ;54 ;1|533;宝勒德巴特尔;42.39290428646587;98.47789360398934;2019-07-05 15:01:16;1041 ;7.504 ;54 ;1|514;恩图格日勒;41.49439175878994;104.96702947593894;2019-09-26 20:19:05;728 ;17.152 ;54 ;1|530;呼格吉勒图;42.18253165847008;101.0913619903324;2019-09-15 14:20:19;0 ;3270.0 ;54 ;0|518;朱有海;41.659334904922034;103.17143124378183;2019-09-13 16:40:02;941.532991349697 ;20.0 ;54 ;0|517;哈达布和;41.72957388015548;103.40170743319254;2019-09-30 21:08:23;0 ;4000.0 ;54 ;0|528;嘎拉巴特尔;41.850000729192665;100.66073455302275;2019-09-30 19:32:27;0 ;4000.0 ;54 ;0|527;乌吉木草;41.95348717187571;101.06839959081044;2019-09-30 17:35:26;0 ;650.0 ;54 ;1|525;达布西拉图;41.95843169213978;101.0581404249088;2019-09-24 15:05:11;0 ;30.0 ;54 ;1|524;哈斯巴根;41.81019052388008;102.88222601049043;2019-09-28 19:44:28;781 ;75.85 ;54 ;1|542;恩克巴雅尔;42.01731602762574;101.54394725081576;2019-03-06 13:46:57;878 ;10.0 ;54 ;1|520;恩克巴雅尔;41.36332800772825;102.36061949206714;2019-09-04 21:48:15;887 ;20.0 ;54 ;1|526;满德格日勒;41.95672056984322;101.06834554051615;2019-09-30 17:42:25;0 ;53.481598 ;54 ;1|532;照日格图;40.797992515031204;104.53015929892399;2019-08-13 11:34:23;0 ;4000.0 ;54 ;0|543;孟根乌拉;38.84858840295943;105.7189249893026;2019-09-28 21:21:16;0 ;510.0 ;54 ;1|549;朝勒门格尔勒;41.748254992894054;104.17890540573514;2019-09-30 08:24:22;956 ;1.4 ;54 ;1|551;呼木吉勒;40.68147881628273;98.6866397712534;2019-09-24 22:53:59;0 ;20.0 ;54 ;1|553;永红;41.05242357474485;98.22789878241996;2019-09-30 13:29:58;1376.15459238831 ;15.611004 ;54 ;1|552;苏和达来;41.94291268648533;101.05664870371277;2019-09-29 07:29:51;0 ;430.0 ;54 ;1|559;巴德玛;42.046142006970385;100.91159487248079;2019-09-30 19:38:13;884 ;15.008 ;54 ;1|557;刘世英;42.57805392961934;101.27290234809776;2019-09-26 17:03:22;0 ;30.0 ;54 ;0|558;扎雅图;42.56664412590771;101.27457099812833;2019-09-28 06:29:08;853 ;40.959 ;54 ;1";
    func(value, action);

//    ttyu.server.doApiText({ action: 'getDataByUrl', url: url }, function (value) {
//        func(value, action); return;
//    });
    return;
    var method = "GET";
    var serviceUrl = url;

    if (serviceUrl.length == 0) {
        alert("请输入请求服务");
        return;
    }
    var data = method == 'GET' ? "" : json;

    var url = serviceUrl;

    $.ajax({
        type: method,
        contentType: 'application/text',
        url: url,
        data: data,
        dataType: 'text',
        success: function (value) {
            func(value, action);
        },
        error: function (req, status, err) {
            alert(status);
        }
    });
}

var ywcj1url = [webPath + "images/ywcj1.png"];
var ywcj2url = [webPath + "images/ywcj2.png"];
var ywcj3url = [webPath + "images/ywcj3.png"];


var xhssurl = [webPath + "images/xcpxhman1.png"]; //红  0
var xhssurl2 = [webPath + "images/xcpxhman2.png"]; //绿  1
var xhssurl3 = [webPath + "images/xcpxhman3.png"]; //蓝  2

function viewData(json, action) {
    if (json.length == 0 || json == "-1" || json == "1") {
        //alert("没有数据!");
        return;
    }
    var strs = new Array(); //定义一数组

    strs = json.split("|"); //字符分割
    var objs = new Array();
    //保护站
    if (action == "bhz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[5];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[5];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //旅游点
    else if (action == "lyd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[13];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[13];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //景观点
    else if (action == "jgd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[6];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[6];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //界碑
    else if (action == "jb") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //界桩
    else if (action == "jz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //宣传碑
    else if (action == "xcp") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //保护点
    else if (action == "bhd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //瞭望塔
    else if (action == "lwt") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //岗哨
    else if (action == "gs") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[7];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[7];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //项目事件
    else if (action == "xmsjgl") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[9];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //高压铁塔
    else if (action == "gytd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[9];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //视频监控
    else if (action == "spjk") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[9];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //通讯基站
    else if (action == "txjz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[10];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //事件上报
    else if (action == "sjcj") {
        var strs = ["8224b7f2-3504-42cc-9d1a-e4e263885545;458;;;527;乌吉木草;2019/9/30 16:29:41 ;202 ;1 ;100.566347 ;41.881756 ;407df8b9-773e-42e1-b1b9-18a01bfaa6a0 ;/upload/2019-09-30/thumb_7e811350-0f3c-41a4-ac8c-357e4a8c742b.jpg ;1 "];
        //var strs = "399a0ab7-ecf3-4c83-8d33-952cd473607a;458;巡逻;一切正常;535;吉日嘎拉;2019/9/3 15:12:10 ;203 ;1 ;98.411267 ;42.282048 ; ;/upload/2019-09-03/thumb_VID20190902103731.mp4 ;2 |ab21da7e-6288-4c83-8900-94dca78ff4bc;458;巡逻;一切正常;535;吉日嘎拉;2019/9/3 15:11:18 ;203 ;1 ;98.411057 ;42.281878 ;458 ; ; |90b7309b-44fc-4ee2-af39-e1595364c47a;458;巡逻;一切正常;535;吉日嘎拉;2019/9/3 15:09:42 ;203 ;1 ;98.411135 ;42.281625 ;458 ;/upload/2019-09-03/thumb_VID20190902103731.mp4 ;2 |d29c9d2c-4ccc-4c47-a19f-6be830ded2a6;458;巡逻;巡逻;535;吉日嘎拉;2019/9/3 15:09:00 ;203 ;1 ;98.411135 ;42.281625 ;458 ;/upload/2019-09-03/thumb_VID20190827090141.mp4 ;2 |050fc2cb-256f-4d42-b906-31912d8d7024;458;巡逻;巡逻;535;吉日嘎拉;2019/9/3 15:06:36 ;203 ;1 ;98.411003 ;42.28173 ;458 ;/upload/2019-09-03/thumb_VID20190827090141.mp4 ;2 |2855538e-ab47-4f32-8ad7-dc5261f50589;458;巡逻;巡逻;535;吉日嘎拉;2019/9/3 15:03:43 ;203 ;1 ;98.41158 ;42.28291 ;458 ;/upload/2019-09-03/thumb_VID20190827090141.mp4 ;2 |87109e4f-a774-4359-8d7d-4da6c319f1a1;458;.救助;火已扑灭;528;嘎拉巴特尔;2019/9/3 7:16:32 ;202 ;1 ;100.610226 ;41.83378 ;458 ;/upload/2019-09-03/thumb_VID20190903070656.mp4 ;2 |cd22ca5b-b130-4fb1-acc0-dae6424b6aa5;458;;巡逻完成;535;吉日嘎拉;2019/9/2 20:07:23 ;203 ;1 ;98.440916 ;42.192556 ;458 ;/upload/2019-09-02/thumb_3c0e36f6-03e5-4f50-9047-71b51d99830b.jpg ;1 |441b8ad6-338f-4299-89ca-fd41517df39f;458;日常巡逻;;557;刘世英;2019/9/2 20:07:08 ;212 ;1 ;101.267516 ;42.588785 ;458 ;/upload/2019-09-02/thumb_c1c68ed0-5664-47d7-b347-3237124f434b.jpg ;1 |45638a8f-f784-4133-9a6c-167d52dc3bcd;458;一切正常;正常;535;吉日嘎拉;2019/9/2 16:20:30 ;203 ;1 ;98.452306 ;42.357137 ;458 ;/upload/2019-09-02/thumb_VID20190902103731.mp4 ;2";
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[9];
            sObj.lat = strmsg[10];
            sObj.fourChar = action + "_" + strmsg[0];
            sObj.status = 1;
            sObj.siteName = strmsg[2] + "\n" + strmsg[5] + "\n" + strmsg[6];
            //sObj.siteName = strmsg[2].substr(0,3) + "...";
            sObj.stream_status = 1
            sObj.siteid = strmsg[0];
            sObj.pic = "http://www.hclbs.com" + strmsg[12];
            //sObj.pic = strmsg[12];
            //sObj.checkimg = gMap.CheckImgExists(sObj.pic);
            sObj.checkimg = "1";
            if (strmsg[13].replace(/(^\s*)|(\s*$)/g, "") == "2") {
                //sObj.checkimg = "0";
                sObj.pic = "http://www.hclbs.com/admin/img/shiping.png";
            }
            if (strmsg[12].replace(/(^\s*)|(\s*$)/g, "") == "") {
                sObj.checkimg = "0";
                sObj.pic = "";
            }
            if (strmsg[13].replace(/(^\s*)|(\s*$)/g, "") == "") {
                sObj.checkimg = "0";
                sObj.pic = "";
            }
            sObj.action = action;
            objs.push(sObj);
        }

    }
    //资源采集addywcj
    else if (action == "ywcj") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[5];
            sObj.lat = strmsg[6];
            sObj.fourChar = action + "_" + strmsg[0];
            sObj.status = 1;
            sObj.siteName = strmsg[4];
            sObj.stream_status = 1
            sObj.siteid = strmsg[0];
            sObj.kind = strmsg[3];
            if (sObj.kind == "02") {
                sObj.img = ywcj1url;
            } else if (sObj.kind == "01") {
                sObj.img = ywcj3url;
            } else {
                sObj.img = ywcj2url;
            }

            sObj.action = action;
            objs.push(sObj);
        }
    }
    //红外相机
    else if (action == "hwxj") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[9];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //样地
    else if (action == "yd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[10];
            sObj.status = 1;
            sObj.siteName = strmsg[3];
            sObj.stream_status = 1
            sObj.siteid = strmsg[10];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //气象站
    else if (action == "qxz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');
            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[8];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1;
            sObj.siteid = strmsg[8];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //电站
    else if (action == "dz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[16];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[16];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //水库
    else if (action == "sk") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[16];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[16];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //居民点
    else if (action == "jmd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[11];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[11];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //样地
    else if (action == "yd") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[10];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[10];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //红外相机
    else if (action == "hwxj") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[9];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[9];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //地名
    else if (action == "dm") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[2];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[3];
            sObj.status = 1;
            sObj.siteName = strmsg[0];
            sObj.stream_status = 1
            sObj.siteid = strmsg[3];
            sObj.action = action;
            objs.push(sObj);
        }
    }
    //本地资源
    else if (action == "bdzy") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(',');

            var sObj = new Object();
            sObj.lon = strmsg[1];
            sObj.lat = strmsg[0];
            sObj.action = action;
            sObj.stream_status = 1

            sObj.siteName = name;
            sObj.name = name;
            sObj.fourChar = action;

            objs.push(sObj);
        }
    } else if (action == "photos") {
        gMap.createPhotos(json);
        return false;
    } else if (action == "xhss") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');
            var sObj = new Object();
            sObj.lon = strmsg[3];
            sObj.lat = strmsg[2];
            sObj.fourChar = action + "_" + strmsg[0];
            sObj.status = 1;
            sObj.siteName = strmsg[1];
            sObj.stream_status = 1
            sObj.siteid = strmsg[0];
            sObj.action = action;
            sObj.xhzt = strmsg[7];

            sObj.img = xhssurl;

            //var sta_str = strmsg[4];
            //sta_str = sta_str.substring(0, 4) + "/" + sta_str.substring(5, 7) + "/" + sta_str.substring(8, 10) + sta_str.substring(10);

            //var sta_date = new Date(sta_str);

            var now_jlsj = new Date(strmsg[4]);
            var now_date = new Date();


            var datadiffm = GetDateDiff(now_jlsj.toString(), now_date.toString(), "minute");

            //var date3 = dateDiff(sta_date, now_date);

            if (strmsg[8] == "1") {
                //if (datadiffm < 30)
                sObj.img = xhssurl3;
                //else
                //sObj.img = xhssurl;
            } else if (strmsg[8] == "0") {
                if (datadiffm < 5)
                    sObj.img = xhssurl2;
                else
                    sObj.img = xhssurl;
            }

            objs.push(sObj);
        }
    }
    //巡护值守
    else if (action == "xhzs") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.lon = strmsg[0];
            sObj.lat = strmsg[1];
            sObj.fourChar = action + "_" + strmsg[5];
            sObj.status = 1;
            sObj.siteName = strmsg[2] + "\n" + strmsg[3] + "-" + strmsg[4];
            sObj.stream_status = 1
            sObj.siteid = strmsg[5];
            sObj.action = action;

            //sObj.img = [webPath + "images/xcpxhman.png"];
            objs.push(sObj);
        }
    }

    if (objs.length > 0) {
        gMap.removeAllPt("photo3");
        gMap.removeAllPt("photo4");
        addSiteFeaturesObjs(objs);
    }
}

//计算时间差
function GetDateDiff(startTime, endTime, diffType) {
    //将xxxx-xx-xx的时间格式，转换为 xxxx/xx/xx的格式
    startTime = startTime.replace(/\-/g, "/");
    endTime = endTime.replace(/\-/g, "/");
    //将计算间隔类性字符转换为小写
    diffType = diffType.toLowerCase();
    var sTime = new Date(startTime); //开始时间
    var eTime = new Date(endTime); //结束时间
    //作为除数的数字
    var timeType = 1;
    switch (diffType) {
        case "second":
            timeType = 1000;
            break;
        case "minute":
            timeType = 1000 * 60;
            break;
        case "hour":
            timeType = 1000 * 3600;
            break;
        case "day":
            timeType = 1000 * 3600 * 24;
            break;
        default:
            break;
    }
    return parseInt((eTime.getTime() - sTime.getTime()) / parseInt(timeType));
}


function dateDiff(date1, date2) {
    var type1 = typeof date1, type2 = typeof date2;
    if (type1 == 'string')
        date1 = stringToTime(date1);
    else if (date1.getTime)
        date1 = date1.getTime();
    if (type2 == 'string')
        date2 = stringToTime(date2);
    else if (date2.getTime)
        date2 = date2.getTime();
    return (date1 - date2) / 1000; //结果是秒
}

function viewData2(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        return;
    }
    var strs = new Array(); //定义一数组

    strs = json.split("|"); //字符分割
    var objs = new Array();
    //功能区划
    if (action == "gnqh") {
        //        for (i = 0; i < strs.length; i++) {
        //            var strmsg = strs[i].split(';');

        //            var sObj = new Object();
        //            sObj.name = strmsg[0];
        //            sObj.strPts = strmsg[1];
        //            sObj.mapArea = strmsg[2];
        //            sObj.sPts = sObj.strPts.split(" ");
        //            sObj.action = action;

        //            objs.push(sObj);
        //        }

        for (i = 1; i < strs.length + 1; i++) {
            //为了区域线颜色（突出缓冲区），强行改变循环顺序
            if (i == strs.length) {
                var strmsg = strs[0].split(';');
            } else {
                var strmsg = strs[i].split(';');
            }


            var sObj = new Object();
            sObj.name = strmsg[0];
            sObj.strPts = strmsg[1];
            sObj.mapArea = strmsg[2];
            sObj.sPts = sObj.strPts.split(" ");
            sObj.action = action;

            objs.push(sObj);
        }
    }
    //图幅
    if (action == "jtb") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.name = strmsg[0];
            sObj.strPts = strmsg[1];
            // sObj.lon = strmsg[3];
            // sObj.lat = strmsg[2];
            sObj.sPts = sObj.strPts.split(" ");
            sObj.action = action;

            objs.push(sObj);
        }
    }
    //乡镇区划
    if (action == "xz") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].split(';');

            var sObj = new Object();
            sObj.name = strmsg[0];
            sObj.strPts = strmsg[1];
            sObj.mapArea = strmsg[2];
            sObj.sPts = sObj.strPts.split(" ");
            sObj.action = action;
            sObj.x = strmsg[3];
            sObj.y = strmsg[4];
            objs.push(sObj);
        }
    }
    if (objs.length > 0) {
        addSiteFeaturesObjs2(objs);
    }
}

function viewData3(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        return;
    }
    var objs = new Array();
    var i = 0
    var strs = json
    //乡镇区划
    legendMap = new Map();
    if (action == "lw") {
        for (i = 0; i < strs.length; i++) {
            var strmsg = strs[i].passingPoint;

            var sObj = new Object();
            sObj.sPts = strmsg.split(';');
            sObj.action = action;
            sObj.type = strs[i].type;
            objs.push(sObj);
        }
        legendMap.set('高速公路', null);
        legendMap.set('国道', null);
        legendMap.set('省道', null);
        legendMap.set('小油路', null);
        legendMap.set('土路', null);
        legendMap.set('沙漠地带路', null);
        legendMap.set('未知', null);
    }
    if (objs.length > 0) {
        var i = 0;
        for (; i < objs.length; i++) {
            var fea = gMap.createPolyline(objs[i]);
            gMap.createLineLegend(fea, legendMap);
        }
    }
    gMap.createLegend(action, legendMap);
}

// 加载基准站元素信息。
function loadSites() {
    requestServlet(sitesUrl);
}

function loadASiteInfo(fourChar, siteid) {
    var url1 = webPath + "/GNSSService?req=getSiteInfo&fourChar=" + fourChar
        + "&siteId=" + siteid;
    requestServlet(url1);
}

function onPopupClose(evt) {
}

function setSiteMesage(fourChar) {
    if (siteObjs != null) {
        var i = 0;
        for (; i < siteObjs.length; i++) {
            if (siteObjs[i].fourChar == fourChar) {
                document.getElementById("td_siteName").innerHTML = siteObjs[i].siteName
                    + "(" + siteObjs[i].fourChar + ")";
                if (siteObjs[i].status == 0) {
                    document.getElementById("td_netStatus").innerHTML = "故障";
                } else if (siteObjs[i].status == 1) {
                    document.getElementById("td_netStatus").innerHTML = "正常";
                }
                break;
            }
        }
    }
}

//鼠标点击显示浮云
function mouseOverFt(eve) {//在地图上单击打开窗口

    gMap.removeAllMessageWindow();

    var xx = eve.target.geometry.x;
    var yy = eve.target.geometry.y;
    currentFea = eve.target;
    /*
    setSiteMesage(eve.target.fourChar);
    document.getElementById("loadtr").style.display = "block";
    document.getElementById("mestr").style.display = "none";
    document.getElementById("siteImg").style.position = "relative";
    document.getElementById("siteImg").style.top = "20px";
    document.getElementById("siteImg").style.left = "20px";
    document.getElementById("siteImg").style.width = "25px";
    document.getElementById("siteImg").style.height = "25px";
    document.getElementById("siteImg").src = webPath + "images/14.gif";
    */

    //得到气泡显示的页面地址，林权图fourChar参数对不上
    if (eve.target.action == "lqt") {

        var url = "http://www.hclbs.com:9006/main/infoview2.aspx?layer=" + eve.target.action + "&id=" + eve.target.siteid;
        document.getElementById("mainframeshow").src = url;
    } else if (eve.target.action == "xhss") {
        var url = "http://www.hclbs.com:9006/main/temp/xhsswindow.aspx?layer=" + eve.target.action + "&id=" + eve.target.siteid;
        //var url = "/main/infoview2.aspx?layer=" + eve.target.fourChar.split('_')[0] + "&id=" + eve.target.siteid;
        document.getElementById("mainframeshow").src = url;
    } else if (eve.target.action == "xhlxbyid_photo") {
        window.open("http://www.hclbs.com:9006/main/childphoto3.aspx?glbm=&glid=" + eve.target.fourChar + "");
        document.getElementById("mainframeshow").src = url;
    } else {
        var url = "http://www.hclbs.com:9006/main/infoview2.aspx?layer=" + eve.target.action + "&id=" + eve.target.siteid;
        document.getElementById("mainframeshow").src = "infoview2.html?id=" + eve.target.siteid;
    }

    // document.getElementById("mainframeshow").src ="infoview2.html?url=" + url;
    if (eve.target.fourChar !== "bdzy" && eve.target.fourChar !== "gnqh" && eve.target.fourChar !== "jtb" && eve.target.fourChar.split('_')[0] !== "dm" && eve.target.action !== "xhlxbyid_photo" && eve.target.fourChar !== "xhlxbyid" && eve.target.action !== "xhlxbyid") {
        comeOutWindow(); //window.frames["mainframeshow"].document.getElementById("iframe中控件的ID").click(); $('#mainframeshow').document
    }

    //loadASiteInfo(eve.target.fourChar, eve.target.siteid);
}

function clickSelect(action, id, showWin) {
    gMap.addEventHandler2("clickSelect", openFuyun3);
}

function openFuyun3(action, id, showWin) {
    var fourchar = action + "_" + id;
    currentFea = gMap.getFeature(fourchar).feature;
    var eve = new Object();
    eve.target = currentFea;
    eve.target.selected = "1";
    eve.target.renderIntent = "select";
    eve.type = "clickSelect";
    gMap.addEventHandler2(eve);
}

function openFuyun(action, id, showWin, url) {//打开窗口
    gMap.removeAllMessageWindow();

    //var layer = gMap.getsmtlayer(action);
    //var fs = layer.features;
    //if (fs != null) {
    //    for (var i = fs.length - 1; i >= 0; i--) {
    //        gMap.removeMessageWindow(fs[i]);
    //    }
    //}

    var fourchar = action + "_" + id;
    currentFea = gMap.getFeature(fourchar).feature;

    if (showWin == 1) {
        var url = "http://www.hclbs.com:9006/main/infoview2.aspx?layer=" + action + "&id=" + id;
    } else if (showWin == "2") {
        if (action = "xhss")
            var url = "http://www.hclbs.com:9006/main/temp/xhsswindow.aspx?layer=" + action + "&id=" + id;
        else {
            var url = "http://www.hclbs.com:9006/main/infoview2.aspx?layer=" + action + "&id=" + id;
        }
    } else {
        var url = "http://www.hclbs.com:9006/main/infoview2.aspx?layer=" + action + "&id=" + id;
    }

    document.getElementById("mainframeshow").src = url;
    comeOutWindow();
}

function openFuyun2(action, id, y, x, showWin, url) {//showWin  标志参数( 1：旧弹出窗(字符串拼接) 2：新弹出窗(main/temp路径下窗口) )

    gMap.removeAllMessageWindow();
    if (url == null) {
        if (showWin = 1) {
            var url = "/main/infoview2.aspx?layer=" + action + "&id=" + id;
        } else if (showWin = 2) {
            var url = "/main/temp/xhsswindow.aspx?layer=" + action + "&id=" + id;
        } else {
            var url = "/main/infoview2.aspx?layer=" + action + "&id=" + id;
        }
    }
    //document.getElementById("mainframeshow2").src = url;
    document.getElementById("mainframeshow").src = url;
    var str = document.getElementById('popw').innerHTML;
    //var str = document.getElementById('popw3').innerHTML;
    gMap.popUpMessageWindow2(y, x, str, onPopupClose);
}

function closefuyun() {
    if (currentFea != null && currentFea.popup != null) {
        closePopMesWindow();
    }
}

function comeOutWindow() {
    if (currentFea.popup != null) {
        closePopMesWindow();
    }
    var str = document.getElementById('popw').innerHTML;
    gMap.popUpMessageWindow(currentFea, str, onPopupClose);
}

function mouseOutFt(eve) {
    gMap.removeMessageWindow(eve.target);
}

function closePopMesWindow() {
    gMap.removeMessageWindow(currentFea);
}

//close all
function closeAllPopMesWindow() {
    gMap.removeAllMessageWindow();
}

function doNothing() {
    return false;
}

function test123(obj) {
    alert(obj);
}

var is_o = false;

function clickMenu(clickTag) {
    is_o = !is_o;
    setlayerVisible(clickTag, is_o)
}

//图层的显示与隐藏
function setlayerVisible(name, flag) {
    if (name == "cz") {
        name = "jmd";
    }
    gMap.setLayerVisible(name, flag);
}

function getPositionLon() {
    return gMap.getPositionLon();
}

//森林小班
function addxbv(XZCode, CZCode, LBCode, XBCode) {
    getpolygonData("addxbv", "xbv", XZCode, CZCode, LBCode, XBCode);
}

function delxbv(XZCode, CZCode, LBCode, XBCode) {
    getpolygonData("addxbv", "xbv-del", XZCode, CZCode, LBCode, XBCode);
}

function addxb(XZCode, CZCode, LBCode) {
    getpolygonData("addxb", "xb", XZCode, CZCode, LBCode, "");
}

function delxb(XZCode, CZCode, LBCode) {
    getpolygonData("addxb", "xb-del", XZCode, CZCode, LBCode, "");
}

function addxball() {
    getpolygonData("addxball", "xball", "", "", "", "");
}

//林权
function addlqcwzh(XZCode, CZCode, LBCode) {
    getpolygonData("addlqcwzh", "lqcwzh", XZCode, CZCode, LBCode, "");
}

function dellqcwzh(XZCode, CZCode, LBCode) {
    getpolygonData("addlqcwzh", "lqcwzh-del", XZCode, CZCode, LBCode, "");
}

function addlqcw(XZCode, CZCode) {

    getpolygonData("addlqcw", "lqcw", XZCode, escape(CZCode), "", "");
}

function dellqcw(XZCode, CZCode) {
    getpolygonData("addlqcw", "lqcw-del", XZCode, CZCode, "", "");
}

function setMousePositionStart() {
    return gMap.setMousePositionStart();
}

function setMousePositionEnd() {
    return gMap.setMousePositionEnd();
}

function getPositionLon() {
    return gMap.getPositionLon();
}

function getPositionLat() {
    return gMap.getPositionLat();
}

function addxbsql() {
    if (gMap.getaddxbsql().features.length > 0) {
        gMap.setLayerVisible("xb", true);
    } else {
        //清除原来的加载点。
        getData("getsbss&SBLX=06", "gs");
    }
}

function removeAllPt(layername) {
    if (layername == "cz") {
        layername = "jmd";
    }
    if (layername == "sbss") {
        return;
    }
    if (layername == "xhry") {
        layername = "xhlxbyid";
    }
    return gMap.removeAllPt(layername);
}

function getRenderableCount(layername) {
    return gMap.getRenderableCount(layername);
}

function setlayerVisibleAll() {
    gMap.makeCenter();
    return gMap.setlayerVisibleAll();
}

function reMovePosition() {
    return gMap.removeAllPt("com");
}

function reMovePt(element) {
    return gMap.removeAllPt(element);
}

function addbhz(name) {
    //    1.判断是否已经加载了--》实现判断已经加载的方法
    //    2.是，显示图层--》
    //    3.否，重新加载。--》

    var len = gMap.getRenderableCount("bhz");
    if (len > 0) {
        gMap.setLayerVisible("bhz", true);
    } else {
        getData("getbhz", "bhz");
        window.close("infoView2.aspx");
    }
}

function addsbss(sLX, name) {

    if (sLX === "01") {
        var len = gMap.getRenderableCount("jb");
        if (len > 0) {
            gMap.setLayerVisible("jb", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "jb");
        }
    } else if (sLX === "02") {
        var len = gMap.getRenderableCount("jz");
        if (len > 0) {
            gMap.setLayerVisible("jz", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "jz");
        }
    } else if (sLX === "03") {
        var len = gMap.getRenderableCount("xcp");
        if (len > 0) {
            gMap.setLayerVisible("xcp", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "xcp");
        }
    } else if (sLX === "04") {
        var len = gMap.getRenderableCount("bhd");
        if (len > 0) {
            gMap.setLayerVisible("bhd", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "bhd");
        }
    } else if (sLX === "05") {
        var len = gMap.getRenderableCount("lwt");
        if (len > 0) {
            gMap.setLayerVisible("lwt", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "lwt");
        }
    } else if (sLX === "06") {
        var len = gMap.getRenderableCount("gs");
        if (len > 0) {
            gMap.setLayerVisible("gs", true);
        } else {
            getData("getsbss&SBLX=" + sLX, "gs");
        }
    }
}

//坐标定位
function gotoLatLonBZ(lat, lon, gd, zb, jd)// 经度，纬度，俯视高度，正北方向，俯视角度
{
    if (lat == 0 && lon == 0) {
        alert("经纬度信息错误，无法定位！");
        return;
    }
    gMap.gotoLatLonBZ(lon, lat);
}

function getpolygonData(vType, action, strX, strC, strLB, VXBH) {
    //"action=" + action + "&XDM=" + strX + "&CDM=" + strC + "&LBH=" + strLB + "&XBH=" + VXBH);
    var jsonParams = '{"action":"' + vType + '"}';
    var url = "http://www.hclbs.com:9006/webService.ashx?regid=" + regId + "&action=" + vType + "&XDM=" + strX + "&CDM=" + strC + "&LBH=" + strLB + "&XBH=" + VXBH + "&vaction=" + action;
    executeService(url, jsonParams, viewPolygonData, action);
}

function viewPolygonData(json, action) {
    if (json.length == 0) {
        //alert("没有数据!");
        return;
    }
    //小班
    if (action == "xbv") {
        gMap.createSLXBPolygon(json, action);
    } else if (action == "xbv-del") {
        gMap.DelSLXBPolygon(json);
    } else if (action == "xb") {
        gMap.createSLXBPolygon(json, action);
    } else if (action == "xb-del") {
        gMap.DelSLXBPolygon(json);
    } else if (action == "xball") {
        gMap.createSLXBPolygon(json, action);
    }
    //林权
    else if (action == "lqcwzh") {
        gMap.createLQTPolygon(json, action);
    } else if (action == "lqcwzh-del") {
        gMap.DelLQTPolygon(json);
    } else if (action == "lqcw") {
        gMap.createLQTPolygon(json, action);
    } else if (action == "lqcw-del") {
        gMap.DelLQTPolygon(json);
    }
}

function gotoLatLon(lat, lon, zoom, zb, jd)// 经度，纬度，俯视高度，正北方向，俯视角度
{
    if (lat == 0 && lon == 0) {
        alert("经纬度信息错误，无法定位！");
        return;
    }
    if (zoom >= 19)
        zoom = centerPoint.minzoom;
    gMap.gotoLatLon(lon, lat, zoom);
}

function viewRefresh() {

}

//测距
function setLine() {
    gMap.toggleControl('line');
}

//测面
function setPolygon() {
    gMap.toggleControl('polygon');
}

//测面
function setClear() {
    gMap.clearFeature();
}

//基础数据管理的图层隐藏(layer.html调用)
function getLayerVisible(layname) {
    setlayerVisible(layname, true);
}

//陆洲
function addxhss(username) {
    var len = gMap.getRenderableCount("xhss");
    if (len > 0) {
        gMap.setLayerVisible("xhss", true);
        gMap.removeAllPt("xhss");
        getData(encodeURI("addxhss&username=" + username), "xhss");
    } else {
        getData(encodeURI("addxhss&username=" + username), "xhss");
    }
}

function addxhss2(idarray) {
    gMap.removeAllPt("xhss");
    var len = gMap.getRenderableCount("xhss");
    if (len > 0) {
        gMap.setLayerVisible("xhss", true);
        gMap.removeAllPt("xhss");
        getData("addxhss2&useridarray=" + idarray, "xhss");
    } else {
        getData("addxhss2&useridarray=" + idarray, "xhss");
    }
}

function addhwxj(name) {
    gMap.removeAllPt("hwxj");
    var len = gMap.getRenderableCount("hwxj");
    if (len > 0) {
        gMap.setLayerVisible("hwxj", true);
    } else {
        getData("gethwxj", "hwxj");
    }
}

function addyd(name) {
    gMap.removeAllPt("yd");
    var len = gMap.getRenderableCount("yd");
    if (len > 0) {
        gMap.setLayerVisible("yd", true);
    } else {
        getData("getyd", "yd");
    }
}

function addtxjz(name) {
    gMap.removeAllPt("txjz");
    var len = gMap.getRenderableCount("txjz");
    if (len > 0) {
        gMap.setLayerVisible("txjz", true);
    } else {
        getData("gettxjz", "txjz");
    }
}

function addsjcj(name, lczt, bhzbh, xhid, sjlx) {   //name,lczt,保护站,巡护id,类型
    gMap.removeAllPt("sjcj");
    gMap.setLayerVisible("sjcj", true);
    var len = gMap.getRenderableCount("sjcj");
    if (len > 0) {
        gMap.setLayerVisible("sjcj", true);
    } else {
        getData("addsjcj&lczt=" + lczt + "&sjlx=" + lczt + "&xhid=" + xhid + "&bhzbh=" + bhzbh, "sjcj");
    }
}


//巡护里面得事件上报
function addsjcj1(name, lczt, bhzbh, xhid, sjlx, pageSize, pageIndex) {
    gMap.removeAllPt("sjcj");
    gMap.setLayerVisible("sjcj", true);
    var len = gMap.getRenderableCount("sjcj");
    if (len > 0) {
        gMap.setLayerVisible("sjcj", true);
    } else {
        getData("addsjcj1&lczt=" + lczt + "&sjlx=" + lczt + "&xhid=" + xhid + "&bhzbh=" + bhzbh + "&pageSize=" + pageSize + "&pageIndex=" + pageIndex, "sjcj");
    }
}

function addsjcj2(idarray) {
    gMap.removeAllPt("sjcj");
    gMap.setLayerVisible("sjcj", true);
    var len = gMap.getRenderableCount("sjcj");
    if (len > 0) {
        gMap.setLayerVisible("sjcj", true);
    } else {
        getData("addsjcj2&idarray=" + idarray, "sjcj");
    }
}

function addywcj(name, zydl, bhzbh, xhid, sfsp) {   //name,资源大类,保护站,巡护id,sfsp
    gMap.removeAllPt("ywcj");
    gMap.setLayerVisible("ywcj", true);
    var len = gMap.getRenderableCount("ywcj");
    if (len > 0) {
        gMap.setLayerVisible("ywcj", true);
    } else {
        getData("addywcj&sfsp=" + name + "&zydl=" + zydl + "&xhid=" + xhid + "&bhzbh=" + bhzbh, "ywcj");
    }
}

function addjcsj(departid, syear, stest) {   //name,资源大类,保护站,巡护id,sfsp


    gMap.removeAllPt("jcsj");
    gMap.setLayerVisible("jcsj", true);
    var len = gMap.getRenderableCount("jcsj");
    if (len > 0) {
        gMap.setLayerVisible("jcsj", true);
    } else {
        getData2("addjcsj&departid=" + name + "&syear=" + syear + "&stest=" + stest, "jcsj");
    }
}

function addqxz(name) {
    gMap.removeAllPt("qxz");
    var len = gMap.getRenderableCount("qxz");
    if (len > 0) {
        gMap.setLayerVisible("qxz", true);
    } else {
        getData("getqxz", "qxz");
    }
}

function addgytd(name) {
    gMap.removeAllPt("gytd");
    var len = gMap.getRenderableCount("gytd");
    if (len > 0) {
        gMap.setLayerVisible("gytd", true);
    } else {
        getData("getgytd", "gytd");
    }
}

function addxmsjgl(name) {
    gMap.removeAllPt("xmsjgl");
    var len = gMap.getRenderableCount("xmsjgl");
    if (len > 0) {
        gMap.setLayerVisible("xmsjgl", true);
    } else {
        getData("getxmsjgl", "xmsjgl");
    }
}

//

function addDZ(name) {
    var len = gMap.getRenderableCount("dz");
    if (len > 0) {
        gMap.setLayerVisible("dz", true);
    } else {
        getData("getdz", "dz");
    }
}

function addsk(name) {
    var len = gMap.getRenderableCount("sk");
    if (len > 0) {
        gMap.setLayerVisible("sk", true);
    } else {
        getData("getsk", "sk");
    }
}

function addlyd(name) {
    var len = gMap.getRenderableCount("lyd");
    if (len > 0) {
        gMap.setLayerVisible("lyd", true);
    } else {
        getData("getlyd", "lyd");
    }
}

function addjgd(name) {
    var len = gMap.getRenderableCount("jgd");
    if (len > 0) {
        gMap.setLayerVisible("jgd", true);
    } else {
        getData("getjgd", "jgd");
    }
}

function adddm(name) {
    var len = gMap.getRenderableCount("dm");
    if (len > 0) {
        gMap.setLayerVisible("dm", true);
    } else {
        getData("getdm", "dm");
    }
}

function addjmd(name) {
    var len = gMap.getRenderableCount("jmd");
    if (len > 0) {
        gMap.setLayerVisible("jmd", true);
    } else {
        getData("getjmd", "jmd");
    }
}

function addgnqh(name) {
    var len = gMap.getRenderableCount("gnqh");
    if (len > 0) {
        gMap.setLayerVisible("gnqh", true);
    } else {
        getData2("getgnqh", "gnqh");
    }
}

function addjtb() {
    var len = gMap.getRenderableCount("jtb");
    if (len > 0) {
        gMap.setLayerVisible("jtb", true);
    } else {
        getData2("getjtb", "jtb");
    }
}

function addspjk() {
    var len = gMap.getRenderableCount("spjk");
    if (len > 0) {
        gMap.setLayerVisible("spjk", true);
    } else {
        getData("getspjk", "spjk");
    }

}

//专题
function setZTTVisibleall() {
    gMap.setlayerVisibleZT();
}

function setlayVisibleAll() {
    gMap.setlayerVisibleAll();
}

function getIsloadXbAll() {
}

function addbdzy(id) {
    gMap.setLayerVisible("bdzy", true);
    gMap.removeAllPt("bdzy");
    gMap.makeCenter();
    getData4("getbdzyname", "bdzy", id);
    getData3("getbdzy", "bdzy", id);
}

//巡护路线图
function addxhlxbyid(XHID) {
    getData5("addxhlxbyid", "xhlxbyid", XHID);
}

function addxhlxbyid2(XHID) {
    getData5_1("addxhlxbyid2", "xhlxbyid", XHID);
}

//巡护路线图根据路线id
function showxhlxbylxid(lxid) {
    getData6("addxhlxbylxid", "xhlxbyid", lxid);
}

//乡镇区划
function addxz() {
    getData2("getxz", "xz");
}

//值守
function addxhzs(id) {
    gMap.removeAllPt("xhzs");
    gMap.setLayerVisible("xhzs", true);
    var len = gMap.getRenderableCount("xhzs");
    if (len > 0) {
        gMap.setLayerVisible("xhzs", true);
    } else {
        getData("addxhzs&id=" + id, "xhzs");
    }
}

//绘制查询图层
function setMeasureToolVisible(elment) {
    gMap.toggleControl(elment);
}

//地图搜索
function getMeasuretoolsPoints() {
    changeMouseState(0);
    return gMap.getLonLatSearch();
}

//移除搜索地图
function RemovePointsSearch(elment) {
    gMap.RemovePointsSearch(elment);
    gMap.setlayerVisibleAll();
    gMap.setLayerVisible("gnqh", true);
}

//注册单击获取经纬度事件
function getLatLon() {
    gMap.getLatLon();
}

//置顶
function setPointTop(layername, id) {
    gMap.setPointTop(layername, id);
}

//置顶(带图，如事件上报)
function setPointTop2(layername, id) {
    gMap.setPointTop2(layername, id);
}

//切换影像图层和矢量图层
function switchyxandsl() {
    if (gMap)
        gMap.switchyxandsl();
}

function createXHLXPolygonEdit(qd, zd, zjds, action) {
    gMap.createXHLXPolygonEdit(qd, zd, zjds, action);
}

//基础数据管理的图层隐藏
function getlayerVisible(layname) {
    var layer = gMap.getsmtlayer(layname);
    return layer.getVisibility();
}

// 初始化地图控件。
function initialize() {
    //document.all("iload").style.visibility = "hidden";
    var wid = document.documentElement.clientWidth - 0;
    var hei = document.documentElement.clientHeight - 0;
    // document.getElementById("gnssMap").style.width = wid + "px";
    // document.getElementById("gnssMap").style.height = hei + "px";

    gMap = new GNSSMap();
    webPath = "./"
    var bhzurl = [webPath + "images/bhz.png", webPath + "images/bhz.png"];
    var jburl = "";

    var sjcjurl = [webPath + "images/sjcj.png", webPath + "images/sjcj.png"];


    var hwxjurl = [webPath + "images/hwxj.png", webPath + "images/hwxj.png"];
    var ydurl = [webPath + "images/yd.png", webPath + "images/yd.png"];
    var qxzurl = [webPath + "images/qxz.png", webPath + "images/qxz.png"];
    var gytdurl = [webPath + "images/gytd.png", webPath + "images/gytd.png"];
    var txjzurl = [webPath + "images/txjz.png", webPath + "images/txjz.png"];
    var xmsjglurl = [webPath + "images/xmsj.png", webPath + "images/xmsj.png"];
    var ywcjurl = [webPath + "images/ywcj1.png", webPath + "images/ywcj1.png"];

    var jburl = [webPath + "images/jb.png", webPath + "images/jb.png"];
    var jzurl = [webPath + "images/jz.png", webPath + "images/jz.png"];
    var xcpurl = [webPath + "images/xcp.png", webPath + "images/xcp.png"];
    var bhdurl = [webPath + "images/bhd.png", webPath + "images/bhd.png"];
    var lwturl = [webPath + "images/lwt.png", webPath + "images/lwt.png"];
    var gsurl = [webPath + "images/gs.png", webPath + "images/gs.png"];

    gMap.initFeatureStyleZT(jburl, jzurl, xcpurl, bhdurl, lwturl, gsurl);

    var lydurl = [webPath + "images/lyd.png", webPath + "images/lyd.png"];
    var jgdurl = [webPath + "images/mgb.png", webPath + "images/mgb.png"];

    var dzurl = [webPath + "images/dz.png", webPath + "images/dz.png"];
    var skurl = [webPath + "images/g7.png", webPath + "images/g7.png"];
    var qxzurl = [webPath + "images/qxz.png", webPath + "images/qxz.png"];
    var jmdurl = [webPath + "images/cz.png", webPath + "images/cz.png"];
    var ydurl = [webPath + "images/yd.png", webPath + "images/yd.png"];
    var hwxjurl = [webPath + "images/hwxj.png", webPath + "images/hwxj.png"];
    var dmurl = [webPath + "images/dm.png", webPath + "images/dm.png"];
    var comurl = [webPath + "images/pos.png", webPath + "images/pos.png"];
    var bdzyurl = [webPath + "images/bdzy.png", webPath + "images/bdzy.png"];
    var xhddurl = [webPath + "images/xhdd.png", webPath + "images/xhdd.png"];
    var xburl = [webPath + "images/ywcj1.png", webPath + "images/ywcj1.png"];
    var lqurl = [webPath + "images/xbd.png", webPath + "images/xbd.png"];
    var spjkurl = [webPath + "images/spjk.png", webPath + "images/spjk.png"];

    var ywcj1url = [webPath + "images/ywcj1.png", webPath + "images/ywcj1.png"];
    var ywcj2url = [webPath + "images/ywcj2.png", webPath + "images/ywcj2.png"];
    var ywcj3url = [webPath + "images/ywcj3.png", webPath + "images/ywcj3.png"];

    var xhzsurl = [webPath + "images/xhzsman.png", webPath + "images/xhzsman.png"];

    gMap.initFeatureStyleZS(bhzurl, lydurl, jgdurl, dzurl, skurl, qxzurl, jmdurl, ydurl, hwxjurl, dmurl, xhddurl);

    gMap.initFeatureStyleLZ(sjcjurl, hwxjurl, ydurl, qxzurl, gytdurl, txjzurl, xmsjglurl, ywcjurl, xhssurl, xhzsurl);

    gMap.initFeatureStyleZJ(comurl, bdzyurl, xburl, lqurl, spjkurl);

    gMap.initCenterPoint(centerPoint);

    gMap.loadMap("gnssMap", webPath + "Openlayers/img/blank.gif", "");

    gMap.addMousePosition("mousePositionCtrl");

    // gMap.addEventHandler("clickSelect", mouseOverFt);
    //
    // gMap.addEventHandler("clickUnSelect", mouseOutFt);
    // gMap.testsss(test123);

    // gMap.activateClickFeatureControl();

    getData2("getgnqh", "gnqh"); //画区
    addxz();
    getData2("getjtb", "jtb");
    getDataLw();

    // if (ttyu.get('isHeads') != "1")
    //    getData2("getxz", "xz");//
    //
    // gMap.CreateG7();

    //getData("getbhz","getbhz")
    //gotoLatLon(centerPoint.lon, centerPoint.lat, centerPoint.minzoom);
    // gotoLatLon(centerPoint.lat, centerPoint.lon, centerPoint.minzoom);
//    gMap.setLayerVisible('dx', false);
    // setlayerVisible("xhss", false);
    // setlayVisibleAll();
    //setZTTVisibleall();
}
